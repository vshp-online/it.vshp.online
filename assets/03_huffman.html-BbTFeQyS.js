import{_ as p,c as t,a,d as e,r as l,o}from"./app-Cku2TPGJ.js";const i="/assets/Huffman-ChEDDUtw.png",c={};function r(m,s){const n=l("Mermaid");return o(),t("div",null,[s[0]||(s[0]=a('<h1 id="_03-алгоритмы-хаффмана-для-кодирования-и-декодирования-данных" tabindex="-1"><a class="header-anchor" href="#_03-алгоритмы-хаффмана-для-кодирования-и-декодирования-данных"><span>03 - Алгоритмы Хаффмана для кодирования и декодирования данных</span></a></h1><p><strong>Алгоритм Хаффмана</strong> (англ. <em>Huffman&#39;s algorithm</em>) — алгоритм оптимального префиксного кодирования некоторого алфавита с минимальной избыточностью.</p><p>Был разработан в 1952 году аспирантом Массачусетского технологического института Дэвидом Альбертом Хаффманом при написании им курсовой работы<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup>.</p><p>Используется во многих программах сжатия данных.</p><p>Предложенный Хаффманом метод кодирования состоит из двух основных этапов:</p><ol><li>Построение оптимального кодового дерева.</li><li>Построение «словаря» код-символ на основе построенного дерева.</li></ol><p><img src="'+i+'" alt="David Albert Huffman" width="240" loading="lazy"><br> David Albert Huffman</p><p>Основная идея алгоритма состоит в следующем: зная вероятности появления символов в сообщении, можно описать процедуру построения кодов переменной длины, состоящих из целого количества битов. Символам с большей вероятностью ставятся в соответствие более короткие коды. Коды Хаффмана обладают свойством префиксности (то есть ни одно кодовое слово не является префиксом другого), что позволяет однозначно их декодировать. Часто благодаря особому свойству префиксности данные коды называют <strong>беспрефиксными.</strong></p><h3 id="математическое-определение" tabindex="-1"><a class="header-anchor" href="#математическое-определение"><span>Математическое определение</span></a></h3><blockquote><p>Пусть <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">{</mo><mrow><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo lspace="0em" rspace="0em">…</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A=\\{ {a_1,a_2,{…},a_n}\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="minner">…</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> — алфавит из <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> различных символов, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>=</mo><mo stretchy="false">{</mo><mrow><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>w</mi><mi>n</mi></msub></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">W=\\{ {w_1,w_2,…,w_n}\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> — соответствующий ему набор положительных целых весов. Тогда набор бинарных кодов <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mo stretchy="false">{</mo><mrow><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>c</mi><mi>n</mi></msub></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">C=\\{ {c_1,c_2,…,c_n}\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>, где <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> является кодом для символа <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, такой, что:</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> не является префиксом для <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">c_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>, при <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo mathvariant="normal">≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">{i}\\ne{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">i</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span>,</li><li>сумма <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow></munder><msub><mi>w</mi><mi>i</mi></msub><mo>⋅</mo><mi mathvariant="normal">∣</mi><msub><mi>c</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mstyle></mrow><annotation encoding="application/x-tex">\\displaystyle\\sum_{ {i}∈[1,n]} {w_i}⋅|c_i|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.566em;vertical-align:-1.516em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span> минимальна (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>c</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|c_i|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span> — длина кода <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>),<br> называется <strong>кодом Хаффмана</strong>.</li></ul></blockquote><h3 id="алгоритм-построения-бинарного-кода-хаффмана" tabindex="-1"><a class="header-anchor" href="#алгоритм-построения-бинарного-кода-хаффмана"><span>Алгоритм построения бинарного кода Хаффмана</span></a></h3><p>Построение кода Хаффмана сводится к построению соответствующего бинарного дерева по следующему алгоритму: <sup class="footnote-ref"><a href="#footnote2">[2]</a><a class="footnote-anchor" id="footnote-ref2"></a></sup></p><ol><li>Составим список кодируемых символов, при этом будем рассматривать один символ как дерево, состоящее из одного элемента c весом, равным частоте появления символа в строке.</li><li>Из списка выберем два узла с наименьшим весом по следующему правилу: <ul><li>Всегда выбираются два узла с наименьшими весами.</li><li>Если веса равны, предпочтение отдается узлу, который был создан раньше (это важно для воспроизводимости результатов).</li></ul></li><li>Сформируем новый узел с весом, равным сумме весов выбранных узлов, и присоединим к нему два выбранных узла в качестве детей.</li><li>Добавим к списку только что сформированный узел вместо двух объединенных узлов.</li><li>Если в списке больше одного узла, то повторим пункты со второго по пятый.</li></ol><h3 id="пример-построения-дерева-хаффмана" tabindex="-1"><a class="header-anchor" href="#пример-построения-дерева-хаффмана"><span><strong>Пример построения дерева Хаффмана</strong></span></a></h3><p>Закодируем слово <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>b</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>b</mi><mi>r</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">abracadabra</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">ab</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal">ab</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span></span></span></span>. Тогда алфавит будет <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">{</mo><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><mi>c</mi><mo separator="true">,</mo><mi>d</mi></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A=\\{ {a,b,r,c,d}\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span></span><span class="mclose">}</span></span></span></span>, а набор весов (частота появления символов алфавита в кодируемом слове) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>=</mo><mo stretchy="false">{</mo><mrow><mn>5</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn></mrow><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">W=\\{ {5,2,2,1,1}\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span></span><span class="mclose">}</span></span></span></span>.</p><p>В дереве Хаффмана будет <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> узлов:</p><table><thead><tr><th>Узел</th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></th></tr></thead><tbody><tr><td>Вес</td><td>5</td><td>2</td><td>2</td><td>1</td><td>1</td></tr></tbody></table><p>По алгоритму возьмем два символа с наименьшей частотой — это <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> и <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>. Сформируем из них новый узел <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">cd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span> весом <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> (сумма весов каждого из узлов) и добавим его к списку узлов:</p><table><thead><tr><th>Узел</th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">cd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span></th></tr></thead><tbody><tr><td>Вес</td><td>5</td><td>2</td><td>2</td><td>2</td></tr></tbody></table><p>Затем опять объединим в один узел два минимальных по весу узла — <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> и <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>:</p><table><thead><tr><th>Узел</th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">cd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">br</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></th></tr></thead><tbody><tr><td>Вес</td><td>5</td><td>2</td><td>4</td></tr></tbody></table><p>Еще раз повторим эту же операцию, но для узлов <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">cd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span></span></span></span> и <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">br</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>:</p><table><thead><tr><th>Узел</th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>d</mi><mi>b</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">cdbr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></th></tr></thead><tbody><tr><td>Вес</td><td>5</td><td>6</td></tr></tbody></table><p>На последнем шаге объединим два узла — <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> и <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>d</mi><mi>b</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">cdbr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>:</p><table><thead><tr><th>Узел</th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>c</mi><mi>d</mi><mi>b</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">acdbr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></th></tr></thead><tbody><tr><td>Вес</td><td>11</td></tr></tbody></table><p>Остался один узел, значит, мы пришли к корню дерева Хаффмана.</p>',26)),e(n,{code:"eJxLL0osyFAIceHiUlVVuDDvwsYL+y5sv7D3woaL7Re2AukdF7YqXGwGCu0GSmziUlBQcIxWSlTQMNVUigXxnKKVkhQ0jKC8oGilIgTPOVopWUHDEMpziVZKQfCcgRqTgXyYWieg1iSgXhOYvAtIJDkFJGYGM93fPwRoOUTQEGwSPlc3Xth0sR8ovPXCTphuBV1duxqDGgVHFAHDGrB1MGthipydUESAqqBqnOAqkLhAaReIR2CyYO0IzUFcAG2ucb4="}),s[1]||(s[1]=a(`<p>Теперь для каждого символа определим его код — бинарную последовательность, обозначающую путь по дереву к этому символу от корня:</p><table><thead><tr><th>Символ</th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></th></tr></thead><tbody><tr><td>Код</td><td>0</td><td>110</td><td>111</td><td>100</td><td>101</td></tr></tbody></table><p>Таким образом, закодированное слово <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>b</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>b</mi><mi>r</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">abracadabra</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">ab</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal">ab</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span></span></span></span> будет выглядеть как <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0111010100001010111010</mn></mrow><annotation encoding="application/x-tex">0111010100001010111010</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0111010100001010111010</span></span></span></span>. Длина закодированного слова — <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>23</mn></mrow><annotation encoding="application/x-tex">23</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">23</span></span></span></span> бита. Стоит заметить, что если бы мы использовали алгоритм кодирования с одинаковой длиной всех кодовых слов, то закодированное слово заняло бы <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>33</mn></mrow><annotation encoding="application/x-tex">33</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">33</span></span></span></span> бита, что существенно больше.</p><h3 id="реализация-алгоритма-хаффмана-на-языке-fortran-77" tabindex="-1"><a class="header-anchor" href="#реализация-алгоритма-хаффмана-на-языке-fortran-77"><span><strong>Реализация алгоритма Хаффмана на языке Fortran 77</strong></span></a></h3><p>Ниже приводится реализация алгоритма Хаффмана на языке программирования <strong>Fortran 77</strong>. Основой для программы послужил подход, описанный в книге <em>Numerical Recipes in FORTRAN 77: Volume 1, The Art of Scientific Computing</em><sup class="footnote-ref"><a href="#footnote3">[3]</a><a class="footnote-anchor" id="footnote-ref3"></a></sup>. Однако реализация была адаптирована и упрощена для студентов, чтобы она была представлена как единая программа, понятная для изучения.</p><div class="language-fortran line-numbers-mode" data-highlighter="prismjs" data-ext="fortran"><pre><code class="language-fortran"><span class="line">C<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span></span>
<span class="line">C     HUFFMAN ENCODING ALGORITHM</span>
<span class="line">C     WRITTEN BY<span class="token punctuation">:</span> PAVEL TKACHEV</span>
<span class="line">C     BASED ON METHODS FROM<span class="token punctuation">:</span></span>
<span class="line">C     <span class="token string">&quot;NUMERICAL RECIPES IN FORTRAN 77: VOL 1&quot;</span><span class="token punctuation">,</span> <span class="token number">1992</span></span>
<span class="line">C     ADAPTED AND SIMPLIFIED FOR STUDENTS.</span>
<span class="line">C     CONTACT<span class="token punctuation">:</span> PHOENIXWEISS@YA.RU</span>
<span class="line">C     DATE<span class="token punctuation">:</span> DECEMBER <span class="token number">2024</span></span>
<span class="line">C<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span></span>
<span class="line"></span>
<span class="line">      <span class="token keyword">PROGRAM</span> HUFFMAN</span>
<span class="line">      <span class="token keyword">IMPLICIT NONE</span></span>
<span class="line"></span>
<span class="line">C     Constants for array sizes and large <span class="token keyword">integer</span> value</span>
<span class="line">      <span class="token keyword">INTEGER</span> MAXSYM<span class="token punctuation">,</span> MAXNOD<span class="token punctuation">,</span> MAXINT</span>
<span class="line">      <span class="token keyword">PARAMETER</span> <span class="token punctuation">(</span>MAXSYM <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">,</span> MAXNOD <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">,</span> MAXINT <span class="token operator">=</span> <span class="token number">999999999</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">C     Arrays for frequencies<span class="token punctuation">,</span> tree structure<span class="token punctuation">,</span> and parent nodes</span>
<span class="line">      <span class="token keyword">INTEGER</span> FREQ<span class="token punctuation">(</span>MAXNOD<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">INTEGER</span> LEFT<span class="token punctuation">(</span>MAXNOD<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">INTEGER</span> RIGHT<span class="token punctuation">(</span>MAXNOD<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">INTEGER</span> PARENT<span class="token punctuation">(</span>MAXNOD<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">C     Variables for input processing and Huffman tree construction</span>
<span class="line">      <span class="token keyword">INTEGER</span> CHRCOD<span class="token punctuation">,</span> LEN<span class="token punctuation">,</span> N<span class="token punctuation">,</span> NDS</span>
<span class="line">      <span class="token keyword">INTEGER</span> NODE1<span class="token punctuation">,</span> NODE2</span>
<span class="line">      <span class="token keyword">CHARACTER</span><span class="token operator">*</span><span class="token number">1</span> SYM<span class="token punctuation">(</span>MAXSYM<span class="token punctuation">)</span><span class="token punctuation">,</span> CH</span>
<span class="line">      <span class="token keyword">CHARACTER</span><span class="token operator">*</span><span class="token number">256</span> INP</span>
<span class="line">      <span class="token keyword">INTEGER</span> I<span class="token punctuation">,</span> J</span>
<span class="line">      <span class="token keyword">INTEGER</span> MIN1<span class="token punctuation">,</span> MIN2<span class="token punctuation">,</span> ROOT</span>
<span class="line">      <span class="token keyword">INTEGER</span> CODLEN</span>
<span class="line">      <span class="token keyword">CHARACTER</span><span class="token operator">*</span><span class="token number">256</span> CODE</span>
<span class="line">      <span class="token keyword">LOGICAL</span> FOUND</span>
<span class="line"></span>
<span class="line">      <span class="token keyword">INTEGER</span> LENTR</span>
<span class="line">      <span class="token keyword">EXTERNAL</span> LENTR</span>
<span class="line"></span>
<span class="line">      <span class="token keyword">EXTERNAL</span> ENCODE</span>
<span class="line"></span>
<span class="line">C     Initialize arrays</span>
<span class="line">      <span class="token keyword">DO</span> I <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> MAXNOD</span>
<span class="line">         FREQ<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">         LEFT<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">         RIGHT<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">         PARENT<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">      <span class="token keyword">END DO</span></span>
<span class="line"></span>
<span class="line">C     Get input string</span>
<span class="line">      <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&#39;Enter a phrase:&#39;</span></span>
<span class="line">      <span class="token keyword">READ</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token string">&#39;(A)&#39;</span><span class="token punctuation">)</span> INP</span>
<span class="line"></span>
<span class="line">C     Get length of input string without trailing spaces</span>
<span class="line">      LEN <span class="token operator">=</span> LENTR<span class="token punctuation">(</span>INP<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">IF</span> <span class="token punctuation">(</span>LEN <span class="token operator">.EQ.</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span></span>
<span class="line">         <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&#39;Empty input. Exiting.&#39;</span></span>
<span class="line">         <span class="token keyword">STOP</span></span>
<span class="line">      <span class="token keyword">END IF</span></span>
<span class="line"></span>
<span class="line">C     Count frequency of each unique symbol</span>
<span class="line">      N <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">      <span class="token keyword">DO</span> I <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> LEN</span>
<span class="line">         CH <span class="token operator">=</span> INP<span class="token punctuation">(</span>I<span class="token punctuation">:</span>I<span class="token punctuation">)</span></span>
<span class="line">         CHRCOD <span class="token operator">=</span> ICHAR<span class="token punctuation">(</span>CH<span class="token punctuation">)</span></span>
<span class="line">         <span class="token keyword">IF</span> <span class="token punctuation">(</span>CHRCOD <span class="token operator">.LT.</span> <span class="token number">32</span> <span class="token operator">.OR.</span> CHRCOD <span class="token operator">.GT.</span> <span class="token number">126</span><span class="token punctuation">)</span> <span class="token keyword">GOTO</span> <span class="token number">100</span></span>
<span class="line">         FOUND <span class="token operator">=</span> <span class="token boolean">.FALSE.</span></span>
<span class="line">         <span class="token keyword">DO</span> J <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> N</span>
<span class="line">            <span class="token keyword">IF</span> <span class="token punctuation">(</span>CH <span class="token operator">.EQ.</span> SYM<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span></span>
<span class="line">               FOUND <span class="token operator">=</span> <span class="token boolean">.TRUE.</span></span>
<span class="line">               FREQ<span class="token punctuation">(</span>J<span class="token punctuation">)</span> <span class="token operator">=</span> FREQ<span class="token punctuation">(</span>J<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">               <span class="token keyword">GOTO</span> <span class="token number">100</span></span>
<span class="line">            <span class="token keyword">END IF</span></span>
<span class="line">         <span class="token keyword">END DO</span></span>
<span class="line">         N <span class="token operator">=</span> N <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">         SYM<span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">=</span> CH</span>
<span class="line">         FREQ<span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">  <span class="token number">100</span> <span class="token keyword">CONTINUE</span></span>
<span class="line">      <span class="token keyword">END DO</span></span>
<span class="line">      <span class="token keyword">IF</span> <span class="token punctuation">(</span>N <span class="token operator">.EQ.</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span></span>
<span class="line">         <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&#39;No symbols to encode. Exiting.&#39;</span></span>
<span class="line">         <span class="token keyword">STOP</span></span>
<span class="line">      <span class="token keyword">END IF</span></span>
<span class="line"></span>
<span class="line">C     Build Huffman tree</span>
<span class="line">      NDS <span class="token operator">=</span> N</span>
<span class="line">      <span class="token keyword">DO</span> <span class="token keyword">WHILE</span> <span class="token punctuation">(</span>NDS <span class="token operator">.LT.</span> <span class="token number">2</span> <span class="token operator">*</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">         MIN1 <span class="token operator">=</span> MAXINT</span>
<span class="line">         MIN2 <span class="token operator">=</span> MAXINT</span>
<span class="line">         NODE1 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line">         NODE2 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line"></span>
<span class="line">C        Find two nodes with smallest frequencies</span>
<span class="line">         <span class="token keyword">DO</span> I <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> NDS</span>
<span class="line">            <span class="token keyword">IF</span> <span class="token punctuation">(</span>PARENT<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">.NE.</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">GOTO</span> <span class="token number">200</span></span>
<span class="line">            <span class="token keyword">IF</span> <span class="token punctuation">(</span>FREQ<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">.LT.</span> MIN1<span class="token punctuation">)</span> <span class="token keyword">THEN</span></span>
<span class="line">               MIN2 <span class="token operator">=</span> MIN1</span>
<span class="line">               NODE2 <span class="token operator">=</span> NODE1</span>
<span class="line">               MIN1 <span class="token operator">=</span> FREQ<span class="token punctuation">(</span>I<span class="token punctuation">)</span></span>
<span class="line">               NODE1 <span class="token operator">=</span> I</span>
<span class="line">            <span class="token keyword">ELSE</span> <span class="token keyword">IF</span> <span class="token punctuation">(</span>FREQ<span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">.LT.</span> MIN2<span class="token punctuation">)</span> <span class="token keyword">THEN</span></span>
<span class="line">               MIN2 <span class="token operator">=</span> FREQ<span class="token punctuation">(</span>I<span class="token punctuation">)</span></span>
<span class="line">               NODE2 <span class="token operator">=</span> I</span>
<span class="line">            <span class="token keyword">END IF</span></span>
<span class="line">  <span class="token number">200</span>    <span class="token keyword">CONTINUE</span></span>
<span class="line">         <span class="token keyword">END DO</span></span>
<span class="line">         <span class="token keyword">IF</span> <span class="token punctuation">(</span>NODE2 <span class="token operator">.EQ.</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">EXIT</span></span>
<span class="line"></span>
<span class="line">C        Create a new parent node for the two smallest nodes</span>
<span class="line">         NDS <span class="token operator">=</span> NDS <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">         FREQ<span class="token punctuation">(</span>NDS<span class="token punctuation">)</span> <span class="token operator">=</span> FREQ<span class="token punctuation">(</span>NODE1<span class="token punctuation">)</span> <span class="token operator">+</span> FREQ<span class="token punctuation">(</span>NODE2<span class="token punctuation">)</span></span>
<span class="line">         LEFT<span class="token punctuation">(</span>NDS<span class="token punctuation">)</span> <span class="token operator">=</span> NODE1</span>
<span class="line">         RIGHT<span class="token punctuation">(</span>NDS<span class="token punctuation">)</span> <span class="token operator">=</span> NODE2</span>
<span class="line">         PARENT<span class="token punctuation">(</span>NODE1<span class="token punctuation">)</span> <span class="token operator">=</span> NDS</span>
<span class="line">         PARENT<span class="token punctuation">(</span>NODE2<span class="token punctuation">)</span> <span class="token operator">=</span> NDS</span>
<span class="line">      <span class="token keyword">END DO</span></span>
<span class="line"></span>
<span class="line">      ROOT <span class="token operator">=</span> NDS</span>
<span class="line"></span>
<span class="line">C     Generate and display Huffman codes for each symbol</span>
<span class="line">      <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">&#39;Huffman Codes:&#39;</span></span>
<span class="line">      <span class="token keyword">DO</span> I <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> N</span>
<span class="line">         <span class="token keyword">CALL</span> ENCODE<span class="token punctuation">(</span>I<span class="token punctuation">,</span> PARENT<span class="token punctuation">,</span> LEFT<span class="token punctuation">,</span> RIGHT<span class="token punctuation">,</span> ROOT<span class="token punctuation">,</span> CODE<span class="token punctuation">,</span> CODLEN<span class="token punctuation">)</span></span>
<span class="line">         <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token string">&#39;(A1, A3, A)&#39;</span><span class="token punctuation">)</span> SYM<span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39; -&gt; &#39;</span><span class="token punctuation">,</span> CODE<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>CODLEN<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">END DO</span></span>
<span class="line"></span>
<span class="line">      <span class="token keyword">END</span></span>
<span class="line"></span>
<span class="line">C<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span></span>
<span class="line">C     _Function to compute length of string without trailing spaces</span>
<span class="line">      <span class="token keyword">INTEGER</span> <span class="token keyword">FUNCTION</span> LENTR<span class="token punctuation">(</span>STR<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">CHARACTER</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> STR</span>
<span class="line">      <span class="token keyword">INTEGER</span> J<span class="token punctuation">,</span> CHRCOD</span>
<span class="line">      LENTR <span class="token operator">=</span> LEN<span class="token punctuation">(</span>STR<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">DO</span> J <span class="token operator">=</span> LENTR<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line">         CHRCOD <span class="token operator">=</span> ICHAR<span class="token punctuation">(</span>STR<span class="token punctuation">(</span>J<span class="token punctuation">:</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">         <span class="token keyword">IF</span> <span class="token punctuation">(</span>CHRCOD <span class="token operator">.NE.</span> <span class="token number">10</span> <span class="token operator">.AND.</span> CHRCOD <span class="token operator">.NE.</span> <span class="token number">13</span> <span class="token operator">.AND.</span></span>
<span class="line">     <span class="token number">1</span>       CHRCOD <span class="token operator">.NE.</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span></span>
<span class="line">            LENTR <span class="token operator">=</span> J</span>
<span class="line">            <span class="token keyword">RETURN</span></span>
<span class="line">         <span class="token keyword">END IF</span></span>
<span class="line">      <span class="token keyword">END DO</span></span>
<span class="line">      LENTR <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">      <span class="token keyword">END</span></span>
<span class="line"></span>
<span class="line">C<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span></span>
<span class="line">C     _Subroutine to generate Huffman code for a given symbol</span>
<span class="line">      <span class="token keyword">SUBROUTINE</span> ENCODE<span class="token punctuation">(</span>NODE<span class="token punctuation">,</span> PARENT<span class="token punctuation">,</span> LEFT<span class="token punctuation">,</span> RIGHT<span class="token punctuation">,</span> ROOT<span class="token punctuation">,</span> CODE<span class="token punctuation">,</span> LEN<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">INTEGER</span> NODE</span>
<span class="line">      <span class="token keyword">INTEGER</span> PARENT<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> LEFT<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RIGHT<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ROOT<span class="token punctuation">,</span> LEN</span>
<span class="line">      <span class="token keyword">CHARACTER</span><span class="token operator">*</span><span class="token number">256</span> CODE</span>
<span class="line">      <span class="token keyword">CHARACTER</span><span class="token operator">*</span><span class="token number">1</span> PATH<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">INTEGER</span> POS<span class="token punctuation">,</span> CUR<span class="token punctuation">,</span> I</span>
<span class="line"></span>
<span class="line">C     Initialize variables</span>
<span class="line">      POS <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">      LEN <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">      CODE <span class="token operator">=</span> <span class="token string">&#39;&#39;</span></span>
<span class="line">      CUR <span class="token operator">=</span> NODE</span>
<span class="line"></span>
<span class="line">C     Trace path from node to root to generate the code</span>
<span class="line">  <span class="token number">300</span> <span class="token keyword">CONTINUE</span></span>
<span class="line">      <span class="token keyword">IF</span> <span class="token punctuation">(</span>CUR <span class="token operator">.EQ.</span> ROOT<span class="token punctuation">)</span> <span class="token keyword">GOTO</span> <span class="token number">400</span></span>
<span class="line">      POS <span class="token operator">=</span> POS <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">      <span class="token keyword">IF</span> <span class="token punctuation">(</span>LEFT<span class="token punctuation">(</span>PARENT<span class="token punctuation">(</span>CUR<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.EQ.</span> CUR<span class="token punctuation">)</span> <span class="token keyword">THEN</span></span>
<span class="line">         PATH<span class="token punctuation">(</span>POS<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span></span>
<span class="line">      <span class="token keyword">ELSE</span></span>
<span class="line">         PATH<span class="token punctuation">(</span>POS<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&#39;1&#39;</span></span>
<span class="line">      <span class="token keyword">END IF</span></span>
<span class="line">      CUR <span class="token operator">=</span> PARENT<span class="token punctuation">(</span>CUR<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">GOTO</span> <span class="token number">300</span></span>
<span class="line">  <span class="token number">400</span> <span class="token keyword">CONTINUE</span></span>
<span class="line"></span>
<span class="line">C     Reverse path to form the final code</span>
<span class="line">      LEN <span class="token operator">=</span> POS</span>
<span class="line">      <span class="token keyword">DO</span> I <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> POS</span>
<span class="line">         CODE<span class="token punctuation">(</span>I<span class="token punctuation">:</span>I<span class="token punctuation">)</span> <span class="token operator">=</span> PATH<span class="token punctuation">(</span>POS <span class="token operator">-</span> I <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">END DO</span></span>
<span class="line">      <span class="token keyword">RETURN</span></span>
<span class="line">      <span class="token keyword">END</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Программа реализует алгоритм Хаффмана для сжатия текста.</p><h4 id="основные-особенности-программы" tabindex="-1"><a class="header-anchor" href="#основные-особенности-программы"><span>Основные особенности программы</span></a></h4><ol><li><p><strong>Ввод строки и подсчёт частот символов:</strong></p><ul><li>Пользователь вводит строку.</li><li>Программа автоматически подсчитывает частоту появления каждого символа, используя ASCII-коды. Это позволяет избежать ручного ввода частот.</li></ul></li><li><p><strong>Построение дерева Хаффмана:</strong></p><ul><li>На основе частот создаётся бинарное дерево.</li><li>Два узла с наименьшими частотами объединяются в новый узел, пока не останется один корневой узел.</li></ul></li><li><p><strong>Генерация кодов:</strong></p><ul><li>Для каждого символа определяется уникальный код Хаффмана.</li><li>Код строится путём обхода дерева от символа к корню (левый поворот = 0, правый поворот = 1).</li></ul></li><li><p><strong>Вывод результатов:</strong></p><ul><li>Для каждого символа отображается его уникальный код.</li><li>Кодированная строка создаётся путём замены символов на их коды.</li></ul></li><li><p><strong>Использование простых структур данных:</strong></p><ul><li>Программа работает с массивами для хранения частот, связей дерева и узлов, что упрощает реализацию и обеспечивает совместимость со стандартом Fortran-77.</li></ul></li></ol><h4 id="как-запустить-программу" tabindex="-1"><a class="header-anchor" href="#как-запустить-программу"><span>Как запустить программу</span></a></h4><ol><li><p><strong>Сохранение кода</strong>:</p><ul><li>Скопируйте программу в текстовый файл и сохраните его с расширением <code>.f</code>, например, <code>huffman.f</code>.</li></ul></li><li><p><strong>Установка компилятора Fortran</strong>:</p><ul><li>Убедитесь, что на вашем компьютере установлен компилятор Fortran (например, <strong>gfortran</strong>). Если компилятор не установлен, его можно установить: <ul><li><strong>Linux</strong>: <code>sudo apt install gfortran</code></li><li><strong>MacOS</strong>: <code>brew install gfortran</code></li><li><strong>Windows</strong>: используйте <a href="http://www.mingw.org/" target="_blank" rel="noopener noreferrer">MinGW</a> или WSL (Windows Subsystem for Linux).</li></ul></li></ul></li><li><p><strong>Компиляция программы</strong>:</p><ul><li><p>Откройте терминал, перейдите в директорию с файлом программы и выполните:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">gfortran -ffixed-form <span class="token parameter variable">-o</span> huffman huffman.f</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>В результате будет создан исполняемый файл <code>huffman</code>.</p></li></ul></li><li><p><strong>Запуск программы</strong>:</p><ul><li><p>Выполните команду:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">./huffman</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>На Windows вместо <code>./huffman</code> используйте <code>huffman.exe</code>.</p></li></ul></li><li><p><strong>Проверка на фразе &quot;abracadabra&quot;</strong>:</p><ul><li>После запуска программа запросит ввод строки. Введите <code>abracadabra</code> и нажмите Enter.</li><li>Программа подсчитает частоты символов, построит дерево Хаффмана и выведет коды для каждого символа.</li></ul></li></ol><h4 id="пример-работы-программы" tabindex="-1"><a class="header-anchor" href="#пример-работы-программы"><span>Пример работы программы</span></a></h4><p><strong>Ввод</strong>:</p><div class="language-txt line-numbers-mode" data-highlighter="prismjs" data-ext="txt"><pre><code class="language-txt"><span class="line">Enter a phrase:</span>
<span class="line">abracadabra</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Вывод</strong>:</p><div class="language-txt line-numbers-mode" data-highlighter="prismjs" data-ext="txt"><pre><code class="language-txt"><span class="line">Huffman Codes:</span>
<span class="line">a -&gt; 0</span>
<span class="line">b -&gt; 110</span>
<span class="line">r -&gt; 111</span>
<span class="line">c -&gt; 100</span>
<span class="line">d -&gt; 101</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Программа демонстрирует базовые принципы алгоритма Хаффмана и позволяет студентам изучить его реализацию в классическом процедурном стиле благодаря использованию языка <strong>Fortran 77</strong>, который широко применялся в 1970-1980-х годах для научных и инженерных вычислений, студенты также получают возможность познакомиться с историческим подходом к программированию.</p><h3 id="время-работы" tabindex="-1"><a class="header-anchor" href="#время-работы"><span><strong>Время работы</strong></span></a></h3><p>Если сортировать элементы после каждого суммирования или использовать приоритетную очередь, то алгоритм будет работать за время <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(n\\log n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>.</p><p>Такую асимптотику теоретически возможно улучшить до <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{O(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>, используя обычные массивы.</p><h2 id="список-источников" tabindex="-1"><a class="header-anchor" href="#список-источников"><span>Список источников</span></a></h2><h3 id="что-еще-почитать-по-теме" tabindex="-1"><a class="header-anchor" href="#что-еще-почитать-по-теме"><span>Что ещё почитать по теме</span></a></h3><ul><li><a href="https://disk.yandex.ru/i/ajd01z0zo3q6yg" target="_blank" rel="noopener noreferrer">Кодирование Хаффмана, журнал Монитор, номер 7-8, 1993 год</a></li></ul><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p><a href="https://disk.yandex.ru/i/Sf4RBezF6VA2Dg" target="_blank" rel="noopener noreferrer">Huffman, D. (1952). &quot;A Method for the Construction of Minimum-Redundancy Codes&quot; (PDF). Proceedings of the IRE. 40 (9): 1098—1101.</a> <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li><li id="footnote2" class="footnote-item"><p><a href="https://disk.yandex.ru/i/YfsdeWzVe783Tw" target="_blank" rel="noopener noreferrer">Van Leeuwen, Jan (1976). &quot;On the construction of Huffman trees&quot; (PDF). ICALP: 382-410.</a> <a href="#footnote-ref2" class="footnote-backref">↩︎</a></p></li><li id="footnote3" class="footnote-item"><p><a href="https://disk.yandex.ru/d/G9Twy2Nw58YiFQ" target="_blank" rel="noopener noreferrer">Press, W. H., Teukolsky, S. A., Vetterling, W. T., &amp; Flannery, B. P. (1992). Numerical Recipes in FORTRAN 77: The Art of Scientific Computing (Vol. 1, 2nd ed., p. 896). Cambridge University Press.</a> <a href="#footnote-ref3" class="footnote-backref">↩︎</a></p></li></ol></section>`,25))])}const d=p(c,[["render",r]]),u=JSON.parse(`{"path":"/disciplines/up02/lectures/03_huffman.html","title":"03 - Алгоритмы Хаффмана для кодирования и декодирования данных","lang":"ru-RU","frontmatter":{"description":"03 - Алгоритмы Хаффмана для кодирования и декодирования данных Алгоритм Хаффмана (англ. Huffman's algorithm) — алгоритм оптимального префиксного кодирования некоторого алфавита ...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"03 - Алгоритмы Хаффмана для кодирования и декодирования данных\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-10-25T21:38:29.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://it.vshp.online/disciplines/up02/lectures/03_huffman.html"}],["meta",{"property":"og:site_name","content":"Кафедра ИТ"}],["meta",{"property":"og:title","content":"03 - Алгоритмы Хаффмана для кодирования и декодирования данных"}],["meta",{"property":"og:description","content":"03 - Алгоритмы Хаффмана для кодирования и декодирования данных Алгоритм Хаффмана (англ. Huffman's algorithm) — алгоритм оптимального префиксного кодирования некоторого алфавита ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ru-RU"}],["meta",{"property":"og:updated_time","content":"2025-10-25T21:38:29.000Z"}],["meta",{"property":"article:modified_time","content":"2025-10-25T21:38:29.000Z"}]]},"git":{"updatedTime":1761428309000,"contributors":[{"name":"PAVEL TKACHEV","username":"","email":"phoenixweiss@ya.ru","commits":1}],"changelog":[{"hash":"546d926f390001aa37605e5810db963e64aceaad","time":1761428309000,"email":"phoenixweiss@ya.ru","author":"PAVEL TKACHEV","message":"Update <a href=\\"http://index.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">index.md</a>, <a href=\\"http://index.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">index.md</a>, 01_complexity.md, and 12 more files"}]},"autoDesc":true,"filePathRelative":"disciplines/up02/lectures/03_huffman.md"}`);export{d as comp,u as data};
