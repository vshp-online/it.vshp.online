import{_ as d,c as m,a as u,d as c,w as e,r,o as g,b as s,e as n}from"./app-DHbqBNxu.js";const y={};function b(v,a){const k=r("Mermaid"),i=r("Tabs");return g(),m("div",null,[a[8]||(a[8]=u('<h1 id="мдк-11-01-14-введение-в-транзакции" tabindex="-1"><a class="header-anchor" href="#мдк-11-01-14-введение-в-транзакции"><span>МДК.11.01 - 14 - Введение в транзакции</span></a></h1><p>Реляционные БД проектируются с учётом необходимости сохранения целостности данных. Целостность данных — это полнота, точность и единообразие данных. Для поддержания целостности данных в реляционных БД используется ряд инструментов. В их число входят первичные ключи, внешние ключи, ограничения и другие инструменты. Ограничения целостности позволяют применять практические правила к данным в таблицах и гарантировать точность и надежность данных. Большинство СУБД также поддерживает интеграцию пользовательского кода, который выполняется в ответ на определенные операции в БД.</p><p>Как правило, для поддержания целостности данных в реляционных СУБД используют механизм транзакций. Транзакция в базе данных — это одна или несколько последовательных операций на языке SQL, представляющих собой единую логическую задачу. Транзакция представляет собой неделимое действие, то есть она должна быть выполнена как единое целое и результат должен быть либо записан в базу данных целиком, либо не должен быть записан ни один из его компонентов. Каждая транзакция рассматривается как внутренне связный, надежный и независимый от других транзакций элемент.</p><blockquote><p>Транзакции — это механизм, который позволяет группировать несколько операций базы данных в одну логическую единицу работы.</p></blockquote><p>Для соблюдения целостности данных все транзакции в БД должны соответствовать требованиям <strong>ACID</strong>. Требования <strong>ACID</strong> — набор требований, которые обеспечивают сохранность данных, акроним образован по первым буквам принципов сохранности данных:</p><ol><li><p><strong>Атомарность (Atomicity)</strong>: Транзакция считается атомарной, если все ее операции выполняются либо все успешно, либо ни одна из них не выполняется. Если хотя бы одна операция транзакции не может быть выполнена, то все изменения отменяются.</p></li><li><p><strong>Согласованность (Consistency)</strong>: Транзакция должна приводить базу данных из одного согласованного состояния в другое согласованное состояние. Это означает, что все ограничения целостности должны быть соблюдены во время выполнения транзакции.</p></li><li><p><strong>Изолированность (Isolation)</strong>: Каждая транзакция должна быть выполнена изолированно от других транзакций. Это означает, что результаты одной транзакции не должны быть видны другим транзакциям до тех пор, пока первая транзакция не будет завершена.</p></li><li><p><strong>Долговечность (Durability)</strong>: Результаты успешно завершенной транзакции должны быть постоянными и доступными даже в случае сбоя системы. Это достигается путем записи изменений в постоянное хранилище, такое как жесткий диск.</p></li></ol><p>MySQL 8 обеспечивает поддержку всех этих принципов ACID для транзакций. Он предоставляет различные уровни изоляции, которые позволяют контролировать видимость изменений другим транзакциям. Кроме того, MySQL 8 включает механизмы для обработки сбоев и восстановления данных, чтобы гарантировать долговечность транзакций.</p><p>Использование транзакций в MySQL 8 позволяет обеспечить надежность и целостность данных в приложениях, особенно в ситуациях, когда несколько операций должны быть выполнены атомарно. Это делает их полезными в различных сценариях, таких как финансовые операции, онлайн-покупки или любые другие операции, требующие точности и надежности.</p><h2 id="примеры-использования-транзакции" tabindex="-1"><a class="header-anchor" href="#примеры-использования-транзакции"><span>Примеры использования транзакций</span></a></h2><p>Примеры данной темы используют учебную БД:</p>',10)),c(i,{data:[{id:"Структура БД"},{id:"Дамп"},{id:"Таблицы"}]},{title0:e(({value:t,isActive:l})=>[...a[0]||(a[0]=[n("Структура БД",-1)])]),title1:e(({value:t,isActive:l})=>[...a[1]||(a[1]=[n("Дамп",-1)])]),title2:e(({value:t,isActive:l})=>[...a[2]||(a[2]=[n("Таблицы",-1)])]),tab0:e(({value:t,isActive:l})=>[c(k,{code:"eJxLLXLJTEwvSszlUlAoLU4tKlaoBrIUFDz9QhQyUxQCvMG8MMcgZw/HIIW8xNxUoEAtECcmJ+eX5pXgV1+SWZID0gCRB5kfD1TkBlHk4urs6evoo5CUmJOYlwwzF+KImhpd3fxqhCVWCkoX9l3YcmHHhb26F3Zd2Kd7Yc+FvUCRzUCRPUpcAN0zQl0="})]),tab1:e(({value:t,isActive:l})=>[...a[3]||(a[3]=[s("div",{class:"language-sql line-numbers-mode has-collapsed-lines collapsed","data-highlighter":"prismjs","data-ext":"sql",style:{"--vp-collapsed-lines":"10"}},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token keyword"},"SET"),n(" foreign_key_checks "),s("span",{class:"token operator"},"="),n(),s("span",{class:"token number"},"0"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"DROP"),n(),s("span",{class:"token keyword"},"TABLE"),n(),s("span",{class:"token keyword"},"IF"),n(),s("span",{class:"token keyword"},"EXISTS"),n(" users"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"DROP"),n(),s("span",{class:"token keyword"},"TABLE"),n(),s("span",{class:"token keyword"},"IF"),n(),s("span",{class:"token keyword"},"EXISTS"),n(" accounts"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"CREATE"),n(),s("span",{class:"token keyword"},"TABLE"),n(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("users"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token punctuation"},"(")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("id"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"INT"),n(),s("span",{class:"token operator"},"NOT"),n(),s("span",{class:"token boolean"},"NULL"),n(),s("span",{class:"token keyword"},"AUTO_INCREMENT"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("name"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"VARCHAR"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"255"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"NOT"),n(),s("span",{class:"token boolean"},"NULL"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token keyword"},"PRIMARY"),n(),s("span",{class:"token keyword"},"KEY"),n(),s("span",{class:"token punctuation"},"("),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("id"),s("span",{class:"token punctuation"},"`")]),s("span",{class:"token punctuation"},")")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"LOCK"),n(),s("span",{class:"token keyword"},"TABLES"),n(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("users"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"WRITE"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"INSERT"),n(),s("span",{class:"token keyword"},"INTO"),n(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("users"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"VALUES"),n(),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},","),s("span",{class:"token string"},"'Иванов Иван Иванович'"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},","),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},","),s("span",{class:"token string"},"'Петров Петр Петрович'"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},","),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"3"),s("span",{class:"token punctuation"},","),s("span",{class:"token string"},"'Сидоров Сидор Сидорович'"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"UNLOCK"),n(),s("span",{class:"token keyword"},"TABLES"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"CREATE"),n(),s("span",{class:"token keyword"},"TABLE"),n(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("accounts"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token punctuation"},"(")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("id"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"INT"),n(),s("span",{class:"token operator"},"NOT"),n(),s("span",{class:"token boolean"},"NULL"),n(),s("span",{class:"token keyword"},"AUTO_INCREMENT"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("title"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"VARCHAR"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"255"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token keyword"},"DEFAULT"),n(),s("span",{class:"token boolean"},"NULL"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("user_id"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"INT"),n(),s("span",{class:"token operator"},"NOT"),n(),s("span",{class:"token boolean"},"NULL"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("balance"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"DECIMAL"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"10"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token operator"},"NOT"),n(),s("span",{class:"token boolean"},"NULL"),n(),s("span",{class:"token keyword"},"DEFAULT"),n(),s("span",{class:"token string"},"'0.00'"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token keyword"},"PRIMARY"),n(),s("span",{class:"token keyword"},"KEY"),n(),s("span",{class:"token punctuation"},"("),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("id"),s("span",{class:"token punctuation"},"`")]),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token keyword"},"KEY"),n(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("user_id_idx"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token punctuation"},"("),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("user_id"),s("span",{class:"token punctuation"},"`")]),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token keyword"},"CONSTRAINT"),n(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("user_id"),s("span",{class:"token punctuation"},"`")])]),n(`
`),s("span",{class:"line"},[n("    "),s("span",{class:"token keyword"},"FOREIGN"),n(),s("span",{class:"token keyword"},"KEY"),n(),s("span",{class:"token punctuation"},"("),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("user_id"),s("span",{class:"token punctuation"},"`")]),s("span",{class:"token punctuation"},")")]),n(`
`),s("span",{class:"line"},[n("    "),s("span",{class:"token keyword"},"REFERENCES"),n(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("users"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token punctuation"},"("),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("id"),s("span",{class:"token punctuation"},"`")]),s("span",{class:"token punctuation"},")")]),n(`
`),s("span",{class:"line"},[n("    "),s("span",{class:"token keyword"},"ON"),n(),s("span",{class:"token keyword"},"DELETE"),n(),s("span",{class:"token keyword"},"CASCADE")]),n(`
`),s("span",{class:"line"},[n("    "),s("span",{class:"token keyword"},"ON"),n(),s("span",{class:"token keyword"},"UPDATE"),n(),s("span",{class:"token keyword"},"CASCADE")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"LOCK"),n(),s("span",{class:"token keyword"},"TABLES"),n(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("accounts"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"WRITE"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"INSERT"),n(),s("span",{class:"token keyword"},"INTO"),n(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),n("accounts"),s("span",{class:"token punctuation"},"`")]),n(),s("span",{class:"token keyword"},"VALUES"),n(),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},","),s("span",{class:"token string"},"'Основной'"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"10500.00"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},","),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},","),s("span",{class:"token string"},"'Резервный'"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"3412.57"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},","),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"3"),s("span",{class:"token punctuation"},","),s("span",{class:"token string"},"'Основной'"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"20750.00"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},","),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"4"),s("span",{class:"token punctuation"},","),s("span",{class:"token string"},"'Основной'"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"3"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"25000.00"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},","),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},","),s("span",{class:"token string"},"'Накопительный'"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"5401.75"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"UNLOCK"),n(),s("span",{class:"token keyword"},"TABLES"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"SET"),n(" foreign_key_checks "),s("span",{class:"token operator"},"="),n(),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})]),s("div",{class:"collapsed-lines"})],-1)])]),tab2:e(({value:t,isActive:l})=>[c(i,{data:[{id:"<strong>users</strong>"},{id:"<strong>accounts</strong>"}]},{title0:e(({value:o,isActive:p})=>[...a[4]||(a[4]=[s("strong",null,"users",-1)])]),title1:e(({value:o,isActive:p})=>[...a[5]||(a[5]=[s("strong",null,"accounts",-1)])]),tab0:e(({value:o,isActive:p})=>[...a[6]||(a[6]=[s("table",null,[s("thead",null,[s("tr",null,[s("th",{style:{"text-align":"right"}},"id"),s("th",{style:{"text-align":"left"}},"name")])]),s("tbody",null,[s("tr",null,[s("td",{style:{"text-align":"right"}},"1"),s("td",{style:{"text-align":"left"}},"Иванов Иван Иванович")]),s("tr",null,[s("td",{style:{"text-align":"right"}},"2"),s("td",{style:{"text-align":"left"}},"Петров Петр Петрович")]),s("tr",null,[s("td",{style:{"text-align":"right"}},"3"),s("td",{style:{"text-align":"left"}},"Сидоров Сидор Сидорович")])])],-1)])]),tab1:e(({value:o,isActive:p})=>[...a[7]||(a[7]=[s("table",null,[s("thead",null,[s("tr",null,[s("th",{style:{"text-align":"right"}},"id"),s("th",{style:{"text-align":"left"}},"title"),s("th",{style:{"text-align":"right"}},"user_id"),s("th",{style:{"text-align":"right"}},"balance")])]),s("tbody",null,[s("tr",null,[s("td",{style:{"text-align":"right"}},"1"),s("td",{style:{"text-align":"left"}},"Основной"),s("td",{style:{"text-align":"right"}},"1"),s("td",{style:{"text-align":"right"}},"10500")]),s("tr",null,[s("td",{style:{"text-align":"right"}},"2"),s("td",{style:{"text-align":"left"}},"Резервный"),s("td",{style:{"text-align":"right"}},"1"),s("td",{style:{"text-align":"right"}},"3412.57")]),s("tr",null,[s("td",{style:{"text-align":"right"}},"3"),s("td",{style:{"text-align":"left"}},"Основной"),s("td",{style:{"text-align":"right"}},"2"),s("td",{style:{"text-align":"right"}},"20750")]),s("tr",null,[s("td",{style:{"text-align":"right"}},"4"),s("td",{style:{"text-align":"left"}},"Основной"),s("td",{style:{"text-align":"right"}},"3"),s("td",{style:{"text-align":"right"}},"25000")]),s("tr",null,[s("td",{style:{"text-align":"right"}},"5"),s("td",{style:{"text-align":"left"}},"Накопительный"),s("td",{style:{"text-align":"right"}},"2"),s("td",{style:{"text-align":"right"}},"5401.75")])])],-1)])]),_:2},1024)]),_:1}),a[9]||(a[9]=u(`<h3 id="пример-без-использования-транзакции" tabindex="-1"><a class="header-anchor" href="#пример-без-использования-транзакции"><span>Пример без использования транзакций</span></a></h3><p>Пример работы в данной БД для ситуаций, когда Иванов переводит Петрову деньги с основного счета на основной:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">UPDATE</span> accounts <span class="token keyword">SET</span> balance <span class="token operator">=</span> balance <span class="token operator">-</span> <span class="token number">10000</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">UPDATE</span> accounts <span class="token keyword">SET</span> balance <span class="token operator">=</span> balance <span class="token operator">+</span> <span class="token number">10000</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Здесь потенциально может возникнуть проблема что в процессе выполнения запроса денег не хватит и один из запросов выполнится, а второй — нет.</p><h3 id="пример-с-использованием-транзакции" tabindex="-1"><a class="header-anchor" href="#пример-с-использованием-транзакции"><span>Пример с использованием транзакций</span></a></h3><p>Пример работы с транзакциями в данной БД для ситуаций, когда Иванов переводит Петрову деньги:</p><ol><li>Начинаем транзакцию:</li></ol><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>Получаем текущий баланс Иванова и номер его основного счета:</li></ol><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> balance <span class="token keyword">FROM</span> accounts <span class="token keyword">WHERE</span> user_id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> title <span class="token operator">=</span> <span class="token string">&#39;Основной&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="3"><li>Получаем текущий баланс Петрова и номер его основного счета:</li></ol><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> balance <span class="token keyword">FROM</span> accounts <span class="token keyword">WHERE</span> user_id <span class="token operator">=</span> <span class="token number">2</span>  <span class="token operator">AND</span> title <span class="token operator">=</span> <span class="token string">&#39;Основной&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="4"><li>Выполняем перевод средств от Иванова к Петрову с основного счета на основной:</li></ol><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">UPDATE</span> accounts <span class="token keyword">SET</span> balance <span class="token operator">=</span> balance <span class="token operator">-</span> <span class="token number">10000</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">UPDATE</span> accounts <span class="token keyword">SET</span> balance <span class="token operator">=</span> balance <span class="token operator">+</span> <span class="token number">10000</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>Если всё прошло по плану то фиксируем изменения:</li></ol><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">COMMIT</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Но если необходимо откатить транзакцию в случае ошибки или недостатка средств:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Примечание: В данном примере предполагается, что все операции выполняются в одном соединении с базой данных.</p>`,19))])}const w=d(y,[["render",b]]),E=JSON.parse('{"path":"/disciplines/mdk1101/lectures/14_lecture.html","title":"МДК.11.01 - 14 - Введение в транзакции","lang":"ru-RU","frontmatter":{"description":"МДК.11.01 - 14 - Введение в транзакции Реляционные БД проектируются с учётом необходимости сохранения целостности данных. Целостность данных — это полнота, точность и единообраз...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"МДК.11.01 - 14 - Введение в транзакции\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-10-24T14:30:06.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://it.vshp.online/disciplines/mdk1101/lectures/14_lecture.html"}],["meta",{"property":"og:site_name","content":"Кафедра ИТ"}],["meta",{"property":"og:title","content":"МДК.11.01 - 14 - Введение в транзакции"}],["meta",{"property":"og:description","content":"МДК.11.01 - 14 - Введение в транзакции Реляционные БД проектируются с учётом необходимости сохранения целостности данных. Целостность данных — это полнота, точность и единообраз..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ru-RU"}],["meta",{"property":"og:updated_time","content":"2025-10-24T14:30:06.000Z"}],["meta",{"property":"article:modified_time","content":"2025-10-24T14:30:06.000Z"}]]},"git":{"updatedTime":1761316206000,"contributors":[{"name":"PAVEL TKACHEV","username":"","email":"phoenixweiss@ya.ru","commits":1}],"changelog":[{"hash":"7164abf5ea181652ae6e18935015af58c1253ed4","time":1761316206000,"email":"phoenixweiss@ya.ru","author":"PAVEL TKACHEV","message":"Update 14_lecture.md, 15_lecture.md, 16_lecture.md, and 16 more files"}]},"autoDesc":true,"filePathRelative":"disciplines/mdk1101/lectures/14_lecture.md"}');export{w as comp,E as data};
