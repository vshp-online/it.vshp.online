import{_ as r,c as u,a as o,b as s,d as p,e as n,w as t,r as c,o as k}from"./app-Bmd1-t5t.js";const m={};function b(g,a){const d=c("Mermaid"),i=c("Tabs");return k(),u("div",null,[a[24]||(a[24]=o('<h1 id="ит-03-07-агрегатные-функции-операторы-group-by-и-having" tabindex="-1"><a class="header-anchor" href="#ит-03-07-агрегатные-функции-операторы-group-by-и-having"><span>ИТ.03 - 07 - Агрегатные функции, операторы GROUP BY и HAVING</span></a></h1><h2 id="введение" tabindex="-1"><a class="header-anchor" href="#введение"><span>Введение</span></a></h2><p>На предыдущих занятиях вы освоили выборку и фильтрацию данных (<code>SELECT</code>, <code>WHERE</code>, <code>LIKE</code>, сортировку, ограничение выборки), а также модификаторы <code>DISTINCT</code> и работу с составными условиями. Сегодня — первый шаг к <strong>сводной аналитике по группам</strong>: агрегатные функции, группировка <code>GROUP BY</code> и постфильтрация групп <code>HAVING</code>.</p><h2 id="пример-таблицы-orders" tabindex="-1"><a class="header-anchor" href="#пример-таблицы-orders"><span>Пример таблицы <code>orders</code></span></a></h2><table><thead><tr><th>id</th><th>title</th><th>category</th><th>customer</th><th>amount</th></tr></thead><tbody><tr><td>1</td><td>Футболка BASIC</td><td>Одежда</td><td>ООО Альфа</td><td>5</td></tr><tr><td>2</td><td>носки хлопок</td><td>Одежда</td><td>ООО Бета</td><td>6</td></tr><tr><td>3</td><td>Шорты спортивные</td><td>Одежда</td><td>ИП Сокол</td><td>10</td></tr><tr><td>4</td><td>футболка Basic</td><td>Одежда</td><td>ООО Альфа</td><td>10</td></tr><tr><td>5</td><td>Шорты спортивные</td><td>Одежда</td><td>ЗАО Гелиос</td><td>5</td></tr><tr><td>6</td><td>Носки Хлопок</td><td>Одежда</td><td>ООО Бета</td><td>6</td></tr><tr><td>7</td><td>ФУТБОЛКА BASIC</td><td>Одежда</td><td>ООО Ромашка</td><td>5</td></tr><tr><td>8</td><td>Шорты спортивные</td><td>Одежда</td><td>ООО Вектор</td><td>5</td></tr><tr><td>9</td><td>Носки хлопок</td><td>Одежда</td><td>ИП Атлас</td><td>3</td></tr><tr><td>10</td><td>футболка BASIC</td><td>Одежда</td><td>ООО Альфа</td><td>5</td></tr><tr><td>11</td><td>Носки Хлопок</td><td>Одежда</td><td>ИП Атлас</td><td>3</td></tr><tr><td>12</td><td>Шорты спортивные</td><td>Одежда</td><td>ЗАО Гелиос</td><td>10</td></tr><tr><td>13</td><td>Футболка Basic</td><td>Одежда</td><td>ООО Альфа</td><td>5</td></tr><tr><td>14</td><td>Носки Хлопок</td><td>Одежда</td><td>ООО Бета</td><td>12</td></tr><tr><td>15</td><td>Шорты спортивные</td><td>Одежда</td><td>ООО Вектор</td><td>5</td></tr><tr><td>16</td><td>Кроссовки Trail</td><td>Обувь</td><td>ООО Бета</td><td>2</td></tr><tr><td>17</td><td>Кроссовки Trail</td><td>Обувь</td><td>ООО Альфа</td><td>2</td></tr><tr><td>18</td><td>Кроссовки Trail</td><td>Обувь</td><td>ИП Сокол</td><td>15</td></tr><tr><td>19</td><td>Кроссовки Trail</td><td>Обувь</td><td>ЗАО Гелиос</td><td>30</td></tr><tr><td>20</td><td>Кроссовки Trail</td><td>Обувь</td><td>ООО Ромашка</td><td>1</td></tr><tr><td>21</td><td>Джемпер шерстяной</td><td>Одежда</td><td>ООО Вектор</td><td>7</td></tr><tr><td>22</td><td>Джемпер шерстяной</td><td>Одежда</td><td>ООО Вектор</td><td>7</td></tr><tr><td>23</td><td>Джемпер шерстяной</td><td>Одежда</td><td>ООО Вектор</td><td>7</td></tr><tr><td>24</td><td>Шапка вязаная</td><td>Аксессуары</td><td>ООО Ромашка</td><td>1.</td></tr><tr><td>25</td><td>Шапка вязаная</td><td>Аксессуары</td><td>ООО Ромашка</td><td>1</td></tr><tr><td>26</td><td>Шапка вязаная</td><td>Аксессуары</td><td>ИП Атлас</td><td>1</td></tr><tr><td>27</td><td>Футболка BASIC</td><td>Одежда</td><td>ООО Альфа</td><td>20</td></tr><tr><td>28</td><td>Футболка Basic</td><td>Одежда</td><td>ЗАО Гелиос</td><td>8</td></tr><tr><td>29</td><td>Носки хлопок</td><td>Одежда</td><td>ООО Бета</td><td>1</td></tr><tr><td>30</td><td>Шорты спортивные</td><td>Одежда</td><td>ИП Сокол</td><td>12</td></tr><tr><td>31</td><td>Кеды Canvas</td><td>Обувь</td><td>ООО Альфа</td><td>4</td></tr><tr><td>32</td><td>Кеды Canvas</td><td>Обувь</td><td>ООО Ромашка</td><td>9</td></tr><tr><td>33</td><td>Рюкзак городской</td><td>Аксессуары</td><td>ООО Альфа</td><td>3</td></tr><tr><td>34</td><td>Рюкзак городской</td><td>Аксессуары</td><td>ЗАО Гелиос</td><td>6</td></tr><tr><td>35</td><td>Бутылка для воды</td><td>Спорт</td><td>ИП Атлас</td><td>12</td></tr><tr><td>36</td><td>Фитнес-резинка</td><td>Спорт</td><td>ООО Вектор</td><td>25</td></tr><tr><td>37</td><td>Перчатки лыжные</td><td>Аксессуары</td><td>ООО Бета</td><td>5</td></tr><tr><td>38</td><td>перчатки ЛЫЖНЫЕ</td><td>Аксессуары</td><td>ООО Бета</td><td>7</td></tr><tr><td>39</td><td>Кроссовки Trail</td><td>Обувь</td><td>ООО Вектор</td><td>11</td></tr><tr><td>40</td><td>Кроссовки Trail</td><td>Обувь</td><td>ИП Атлас</td><td>13</td></tr></tbody></table>',5)),a[25]||(a[25]=s("details",{class:"hint-container details"},[s("summary",null,"Код создания таблицы на языке SQL в диалекте SQLite"),s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token keyword"},"CREATE"),n(),s("span",{class:"token keyword"},"TABLE"),n(" orders "),s("span",{class:"token punctuation"},"(")]),n(`
`),s("span",{class:"line"},[n("  id "),s("span",{class:"token keyword"},"INTEGER"),n(),s("span",{class:"token keyword"},"PRIMARY"),n(),s("span",{class:"token keyword"},"KEY"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  title "),s("span",{class:"token keyword"},"TEXT"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  category "),s("span",{class:"token keyword"},"TEXT"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  customer "),s("span",{class:"token keyword"},"TEXT"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  amount "),s("span",{class:"token keyword"},"INTEGER")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"INSERT"),n(),s("span",{class:"token keyword"},"INTO"),n(" orders "),s("span",{class:"token punctuation"},"("),n("id"),s("span",{class:"token punctuation"},","),n(" title"),s("span",{class:"token punctuation"},","),n(" category"),s("span",{class:"token punctuation"},","),n(" customer"),s("span",{class:"token punctuation"},","),n(" amount"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token keyword"},"VALUES")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'Футболка BASIC'"),s("span",{class:"token punctuation"},","),n("         "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Альфа'"),s("span",{class:"token punctuation"},","),n("     "),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'носки хлопок'"),s("span",{class:"token punctuation"},","),n("           "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Бета'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"6"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"3"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'Шорты спортивные'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ИП Сокол'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"10"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"4"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'футболка Basic'"),s("span",{class:"token punctuation"},","),n("         "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Альфа'"),s("span",{class:"token punctuation"},","),n("     "),s("span",{class:"token number"},"10"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'Шорты спортивные'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ЗАО Гелиос'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"6"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'Носки Хлопок'"),s("span",{class:"token punctuation"},","),n("           "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Бета'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"6"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"7"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'ФУТБОЛКА BASIC'"),s("span",{class:"token punctuation"},","),n("         "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Ромашка'"),s("span",{class:"token punctuation"},","),n("   "),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"8"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'Шорты спортивные'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Вектор'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"9"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'Носки хлопок'"),s("span",{class:"token punctuation"},","),n("           "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ИП Атлас'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"3"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"10"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'футболка BASIC'"),s("span",{class:"token punctuation"},","),n("         "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Альфа'"),s("span",{class:"token punctuation"},","),n("     "),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"11"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Носки Хлопок'"),s("span",{class:"token punctuation"},","),n("           "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ИП Атлас'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"3"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"12"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Шорты спортивные'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ЗАО Гелиос'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"10"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"13"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Футболка Basic'"),s("span",{class:"token punctuation"},","),n("         "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Альфа'"),s("span",{class:"token punctuation"},","),n("     "),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"14"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Носки Хлопок'"),s("span",{class:"token punctuation"},","),n("           "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Бета'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"12"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"15"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Шорты спортивные'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Вектор'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"16"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Кроссовки Trail'"),s("span",{class:"token punctuation"},","),n("        "),s("span",{class:"token string"},"'Обувь'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ООО Бета'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"17"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Кроссовки Trail'"),s("span",{class:"token punctuation"},","),n("        "),s("span",{class:"token string"},"'Обувь'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ООО Альфа'"),s("span",{class:"token punctuation"},","),n("     "),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"18"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Кроссовки Trail'"),s("span",{class:"token punctuation"},","),n("        "),s("span",{class:"token string"},"'Обувь'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ИП Сокол'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"15"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"19"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Кроссовки Trail'"),s("span",{class:"token punctuation"},","),n("        "),s("span",{class:"token string"},"'Обувь'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ЗАО Гелиос'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"30"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"20"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Кроссовки Trail'"),s("span",{class:"token punctuation"},","),n("        "),s("span",{class:"token string"},"'Обувь'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ООО Ромашка'"),s("span",{class:"token punctuation"},","),n("   "),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"21"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Джемпер шерстяной'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Вектор'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"7"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"22"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Джемпер шерстяной'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Вектор'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"7"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"23"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Джемпер шерстяной'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Вектор'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"7"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"24"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Шапка вязаная'"),s("span",{class:"token punctuation"},","),n("          "),s("span",{class:"token string"},"'Аксессуары'"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'ООО Ромашка'"),s("span",{class:"token punctuation"},","),n("   "),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"25"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Шапка вязаная'"),s("span",{class:"token punctuation"},","),n("          "),s("span",{class:"token string"},"'Аксессуары'"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'ООО Ромашка'"),s("span",{class:"token punctuation"},","),n("   "),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"26"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Шапка вязаная'"),s("span",{class:"token punctuation"},","),n("          "),s("span",{class:"token string"},"'Аксессуары'"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'ИП Атлас'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"27"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Футболка BASIC'"),s("span",{class:"token punctuation"},","),n("         "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Альфа'"),s("span",{class:"token punctuation"},","),n("     "),s("span",{class:"token number"},"20"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"28"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Футболка Basic'"),s("span",{class:"token punctuation"},","),n("         "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ЗАО Гелиос'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"8"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"29"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Носки хлопок'"),s("span",{class:"token punctuation"},","),n("           "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ООО Бета'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"30"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Шорты спортивные'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'Одежда'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token string"},"'ИП Сокол'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"12"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"31"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Кеды Canvas'"),s("span",{class:"token punctuation"},","),n("            "),s("span",{class:"token string"},"'Обувь'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ООО Альфа'"),s("span",{class:"token punctuation"},","),n("     "),s("span",{class:"token number"},"4"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"32"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Кеды Canvas'"),s("span",{class:"token punctuation"},","),n("            "),s("span",{class:"token string"},"'Обувь'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ООО Ромашка'"),s("span",{class:"token punctuation"},","),n("   "),s("span",{class:"token number"},"9"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"33"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Рюкзак городской'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'Аксессуары'"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'ООО Альфа'"),s("span",{class:"token punctuation"},","),n("     "),s("span",{class:"token number"},"3"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"34"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Рюкзак городской'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'Аксессуары'"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'ЗАО Гелиос'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"6"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"35"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Бутылка для воды'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'Спорт'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ИП Атлас'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"12"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"36"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Фитнес-резинка'"),s("span",{class:"token punctuation"},","),n("         "),s("span",{class:"token string"},"'Спорт'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ООО Вектор'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"25"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"37"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Перчатки лыжные'"),s("span",{class:"token punctuation"},","),n("        "),s("span",{class:"token string"},"'Аксессуары'"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'ООО Бета'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"38"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'перчатки ЛЫЖНЫЕ'"),s("span",{class:"token punctuation"},","),n("        "),s("span",{class:"token string"},"'Аксессуары'"),s("span",{class:"token punctuation"},","),n("  "),s("span",{class:"token string"},"'ООО Бета'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"7"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"39"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Кроссовки Trail'"),s("span",{class:"token punctuation"},","),n("        "),s("span",{class:"token string"},"'Обувь'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ООО Вектор'"),s("span",{class:"token punctuation"},","),n("    "),s("span",{class:"token number"},"11"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"40"),s("span",{class:"token punctuation"},","),n(),s("span",{class:"token string"},"'Кроссовки Trail'"),s("span",{class:"token punctuation"},","),n("        "),s("span",{class:"token string"},"'Обувь'"),s("span",{class:"token punctuation"},","),n("       "),s("span",{class:"token string"},"'ИП Атлас'"),s("span",{class:"token punctuation"},","),n("      "),s("span",{class:"token number"},"13"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])]),s("codapi-snippet",{sandbox:"sqlite",editor:"basic",id:"orders_02_sqlite.sql"})],-1)),a[26]||(a[26]=o(`<h2 id="агрегатные-функции" tabindex="-1"><a class="header-anchor" href="#агрегатные-функции"><span>Агрегатные функции</span></a></h2><blockquote><p>Агрегатная функция — это функция, которая выполняет вычисление на наборе значений и возвращает одиночное значение.</p></blockquote><p>В разных СУБД существует довольно много разных агрегатных функций, но мы рассмотрим основные:</p><table><thead><tr><th style="text-align:left;">Функция</th><th style="text-align:left;">Описание</th></tr></thead><tbody><tr><td style="text-align:left;"><code>COUNT(столбец)</code></td><td style="text-align:left;">Возвращает количество записей</td></tr><tr><td style="text-align:left;"><code>SUM(столбец)</code></td><td style="text-align:left;">Возвращает сумму значений</td></tr><tr><td style="text-align:left;"><code>AVG(столбец)</code></td><td style="text-align:left;">Возвращает среднее значение</td></tr><tr><td style="text-align:left;"><code>MIN(столбец)</code></td><td style="text-align:left;">Возвращает минимальное значение</td></tr><tr><td style="text-align:left;"><code>MAX(столбец)</code></td><td style="text-align:left;">Возвращает максимальное значение</td></tr></tbody></table><div class="hint-container tip"><p class="hint-container-title">Совет</p><p>Функция <code>COUNT()</code> также подходит для подсчета уникальных значений в столбце, используя <code>COUNT(DISTINCT столбец)</code>.</p></div><div class="hint-container info"><p class="hint-container-title">Инфо</p><p>Агрегатные функции применяются для значений не равных <code>NULL</code>. Исключением является функция <code>COUNT(*)</code>, которая считает все строки в таблице, даже те которые содержат <code>NULL</code>.</p></div><h3 id="подсчет-количества-значении" tabindex="-1"><a class="header-anchor" href="#подсчет-количества-значении"><span>Подсчёт количества значений</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> total_orders</span>
<span class="line"><span class="token keyword">FROM</span> orders<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8)),a[27]||(a[27]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[28]||(a[28]=o(`<p><strong>Результат:</strong><br> Сколько всего строк (заказов) в таблице.</p><h3 id="подсчет-суммы-значении" tabindex="-1"><a class="header-anchor" href="#подсчет-суммы-значении"><span>Подсчёт суммы значений</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a[29]||(a[29]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[30]||(a[30]=o(`<p><strong>Результат:</strong><br> Сколько единиц товара продано суммарно.</p><h3 id="подсчет-уникальных-значении" tabindex="-1"><a class="header-anchor" href="#подсчет-уникальных-значении"><span>Подсчёт уникальных значений</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> category<span class="token punctuation">)</span> <span class="token keyword">AS</span> unique_categories</span>
<span class="line"><span class="token keyword">FROM</span> orders<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a[31]||(a[31]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[32]||(a[32]=o(`<p><strong>Результат:</strong><br> Сколько различных категорий товаров встречается в заказах.</p><h2 id="группировка-group-by" tabindex="-1"><a class="header-anchor" href="#группировка-group-by"><span>Группировка <code>GROUP BY</code></span></a></h2><p>Задача группировки — собрать строки с одинаковым значением ключа в логические группы и посчитать по каждой группе агрегаты (итоги).</p><p>Ключевые правила:</p><ul><li>В <code>SELECT</code> после группировки допустимы <strong>только</strong> поля из списка <code>GROUP BY</code> и <strong>агрегатные</strong> выражения.</li><li>Условия по всем строкам исходной таблицы пишутся в блоке <code>WHERE</code> (до группировки), условия по каждой сформированной группе — в блоке <code>HAVING</code> (после группировки).</li><li>Порядок выполнения: <code>SELECT</code> → <code>FROM</code> → <code>WHERE</code> → <code>GROUP BY</code> → <code>HAVING</code> → <code>ORDER BY</code> → <code>LIMIT</code>.</li></ul><div class="hint-container warning"><p class="hint-container-title">Примечание</p><p>В SQLite допускается выбирать в <code>SELECT</code> столбцы, которых нет в <code>GROUP BY</code>, но их значения <strong>недетерминированы</strong>; в MySQL с включённым по-умолчанию режимом <code>ONLY_FULL_GROUP_BY</code> это приведёт к ошибке.<br> Безопасная практика в том чтобы указывать в <code>SELECT</code> — только поля группировки и агрегаты.</p></div><h3 id="простеишая-группировка-по-товару" tabindex="-1"><a class="header-anchor" href="#простеишая-группировка-по-товару"><span>Простейшая группировка по товару</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  title<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> title</span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total_qty <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8)),a[33]||(a[33]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[34]||(a[34]=o(`<p><strong>Результат:</strong><br> Сколько единиц каждого товара продано суммарно.</p><h3 id="группировка-по-покупателю" tabindex="-1"><a class="header-anchor" href="#группировка-по-покупателю"><span>Группировка по покупателю</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  customer<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> customer</span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total_qty <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a[35]||(a[35]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[36]||(a[36]=o(`<p><strong>Результат:</strong><br> Сколько единиц заказал каждый покупатель.</p><h3 id="группировка-по-категории" tabindex="-1"><a class="header-anchor" href="#группировка-по-категории"><span>Группировка по категории</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  category<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> category</span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total_qty <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a[37]||(a[37]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[38]||(a[38]=o(`<p><strong>Результат:</strong><br> Суммарные продажи по категориям.</p><h3 id="группировка-по-двум-ключам-покупатель-×-категория" tabindex="-1"><a class="header-anchor" href="#группировка-по-двум-ключам-покупатель-×-категория"><span>Группировка по двум ключам (покупатель × категория)</span></a></h3><p>Например, если нам необходимо построить «матрицу»: сколько каждый покупатель взял по каждой категории.</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  customer<span class="token punctuation">,</span></span>
<span class="line">  category<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> customer<span class="token punctuation">,</span> category</span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> customer <span class="token keyword">ASC</span><span class="token punctuation">,</span> total_qty <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4)),a[39]||(a[39]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[40]||(a[40]=o(`<p><strong>Результат:</strong><br> Сколько покупатель взял по каждой категории</p><div class="hint-container info"><p class="hint-container-title">Инфо</p><p><code>GROUP BY customer, category</code> формирует группы «покупатель × категория», <code>SUM(amount)</code> считает суммы внутри каждой группы, а <code>ORDER BY</code> упорядочивает вывод.</p></div><h3 id="заказы-на-каждыи-товар" tabindex="-1"><a class="header-anchor" href="#заказы-на-каждыи-товар"><span>Заказы на каждый товар</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  title<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> orders_count</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> title</span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> orders_count <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4)),a[41]||(a[41]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[42]||(a[42]=o(`<p><strong>Результат:</strong><br> Сколько заказов пришлось на каждый товар.</p><h3 id="среднии-размер-заказа" tabindex="-1"><a class="header-anchor" href="#среднии-размер-заказа"><span>Средний размер заказа</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  category<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">AVG</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_per_category</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> category</span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_per_category <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a[43]||(a[43]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[44]||(a[44]=o(`<p><strong>Результат:</strong><br> Средний размер заказа по каждой категории</p><h3 id="группировка-по-выражению" tabindex="-1"><a class="header-anchor" href="#группировка-по-выражению"><span>Группировка по выражению</span></a></h3><div class="hint-container tip"><p class="hint-container-title">Совет</p><p>В SQLite существует функция <code>LOWER(col)</code>, которая приводит переданное ей значение к нижнему регистру. Однако, следует помнить что она не работает для кириллицы! Здесь мы используем <code>LOWER()</code> как учебный приём.</p></div><p>Группировать можно по вычисляемому выражению, например по «нормализованному» названию:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  LOWER<span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token keyword">AS</span> norm_title<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span>  <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> LOWER<span class="token punctuation">(</span>title<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total_qty <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5)),a[45]||(a[45]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[46]||(a[46]=o(`<p><strong>Результат:</strong><br> Объединены возможные варианты регистра в одно наименование (без учёта кириллицы).</p><h2 id="оператор-having" tabindex="-1"><a class="header-anchor" href="#оператор-having"><span>Оператор <code>HAVING</code></span></a></h2><p>Оператор <code>HAVING</code> используется в SQL для фильтрации результатов запроса, которые были сгруппированы с помощью оператора <code>GROUP BY</code>. Он позволяет указать условие, которое должно выполняться для группы, чтобы она была включена в результат.</p><h3 id="выборка-количества-после-группировки-по-клиентам" tabindex="-1"><a class="header-anchor" href="#выборка-количества-после-группировки-по-клиентам"><span>Выборка количества после группировки по клиентам</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  customer<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">COUNT</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">AS</span> orders_count</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> customer</span>
<span class="line"><span class="token keyword">HAVING</span> orders_count <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5)),a[47]||(a[47]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[48]||(a[48]=o(`<p><strong>Результат:</strong><br> Клиенты, у которых не менее 3 заказов.</p><h3 id="выборка-суммы-после-группировки-по-клиентам" tabindex="-1"><a class="header-anchor" href="#выборка-суммы-после-группировки-по-клиентам"><span>Выборка суммы после группировки по клиентам</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  customer<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> customer</span>
<span class="line"><span class="token keyword">HAVING</span> total_qty <span class="token operator">&gt;=</span> <span class="token number">40</span></span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total_qty <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a[49]||(a[49]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[50]||(a[50]=o(`<p><strong>Результат:</strong><br> Покупатели с суммарными закупками не менее 40 единиц</p><h3 id="выборка-минимума-после-группировки-по-категориям" tabindex="-1"><a class="header-anchor" href="#выборка-минимума-после-группировки-по-категориям"><span>Выборка минимума после группировки по категориям</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  category<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">MIN</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> min_per_category</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> category</span>
<span class="line"><span class="token keyword">HAVING</span> min_per_category <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a[51]||(a[51]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[52]||(a[52]=o(`<p><strong>Результат:</strong><br> Категории, в которых минимальный размер заказа не ниже 5.</p><h3 id="выборка-среднего-после-группировки-по-категориям" tabindex="-1"><a class="header-anchor" href="#выборка-среднего-после-группировки-по-категориям"><span>Выборка среднего после группировки по категориям</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  category<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">AVG</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_per_category</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> category</span>
<span class="line"><span class="token keyword">HAVING</span> avg_per_category <span class="token operator">BETWEEN</span> <span class="token number">5</span> <span class="token operator">AND</span> <span class="token number">8</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a[53]||(a[53]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[54]||(a[54]=o(`<p><strong>Результат:</strong><br> Средний размер заказа на категорию в пределах от 5 до 8 включительно.</p><h3 id="выборка-количества-после-группировки-по-категориям" tabindex="-1"><a class="header-anchor" href="#выборка-количества-после-группировки-по-категориям"><span>Выборка количества после группировки по категориям</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  category<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">COUNT</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">AS</span> rows_count</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> category</span>
<span class="line"><span class="token keyword">HAVING</span> rows_count <span class="token operator">&gt;=</span> <span class="token number">3</span></span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> rows_count <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a[55]||(a[55]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[56]||(a[56]=o(`<p><strong>Результат:</strong><br> Категории, по которым сделано не менее 3 строк заказов</p><h3 id="having-без-group-by" tabindex="-1"><a class="header-anchor" href="#having-без-group-by"><span><code>HAVING</code> без <code>GROUP BY</code></span></a></h3><p>Можно фильтровать агрегат по <strong>всей таблице</strong> одной строкой результата:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">HAVING</span> total_qty <span class="token operator">&gt;</span> <span class="token number">60</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4)),a[57]||(a[57]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[58]||(a[58]=o('<p><strong>Результат:</strong><br> Показать суммарные продажи только если они превышают 60.</p><h2 id="сравнение-where-и-having" tabindex="-1"><a class="header-anchor" href="#сравнение-where-и-having"><span>Сравнение <code>WHERE</code> и <code>HAVING</code></span></a></h2><ul><li><code>WHERE</code> фильтрует <strong>строки до</strong> группировки.</li><li><code>HAVING</code> фильтрует <strong>группы после</strong> вычисления агрегатов.</li></ul><p>Механика (упрощённо):</p>',4)),p(d,{code:"eJyFkUFOwkAUhvec4mVWuiCBglsNSAUXiGnFiWkMqW0FEmyxDjGGmGDd6DFcuK9RIjERr/DmCp7EqVOqJWmaWbzM//6Zef835yPv2hqYPoOjegHganLW983xAEirdrx/0CRCA7CHvmOxoedKE0CrZBB84gGf4RI/cAG4wHfY0zptcioNZYM0tU73EOonYJnM6Xv+zaqnGETvtjfMC2/isk2o6cA8Zo56lyyxVKYk0eD78RmUrR1yK3tVg3S0hqpFV/+ZGqq+uzpdgmJxW8wgiyJLJb5Z7IDgG4ZE6tWU/olzHsSdnu17YxH0lc/4PX6JFQIueYAvUW7+gHNhD38fdVy7kMJHW6qmZtCjefRoeUoknbXsVKDLwkoruVhpLjoq0dFyPMcaLKqk9H+waAyL3yW5MmFFOeShCLoo0RdEBH8ARTfc4g=="}),a[59]||(a[59]=o(`<h3 id="пример-1-отобрать-«крупные»-строки-заказов" tabindex="-1"><a class="header-anchor" href="#пример-1-отобрать-«крупные»-строки-заказов"><span>Пример 1. Отобрать «крупные» <strong>строки</strong> заказов</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  category<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">WHERE</span> amount <span class="token operator">&gt;=</span> <span class="token number">25</span></span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> category</span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total_qty <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2)),a[60]||(a[60]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[61]||(a[61]=o(`<p><strong>Результат:</strong><br> Только те строки, где <code>amount &gt;= 25</code> (до группировки).</p><p><strong>Почему так:</strong><br><code>WHERE amount &gt;= 25</code> сначала убирает все строки с меньшими значениями. В <code>GROUP BY category</code> попадают <strong>только</strong> оставшиеся строки; <code>SUM(amount)</code> суммирует уже урезанный набор.</p><p><strong>Интерпретация:</strong><br> останутся лишь те категории, где встретилась <strong>хотя бы одна</strong> «крупная» строка (<code>&gt;= 25</code>), а сумма считается <strong>по крупным строкам</strong>.</p><h3 id="пример-2-отобрать-«крупные»-товары-по-итогу" tabindex="-1"><a class="header-anchor" href="#пример-2-отобрать-«крупные»-товары-по-итогу"><span>Пример 2. Отобрать «крупные» <strong>товары по итогу</strong></span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span></span>
<span class="line">  category<span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_qty</span>
<span class="line"><span class="token keyword">FROM</span> orders</span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> category</span>
<span class="line"><span class="token keyword">HAVING</span> total_qty <span class="token operator">&gt;=</span> <span class="token number">25</span></span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total_qty <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5)),a[62]||(a[62]=s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)),a[63]||(a[63]=o(`<p><strong>Результат:</strong><br> Все строки учитываются, но оставляем только те группы, где суммарные продажи по товару <code>total_qty &gt;= 25</code>.</p><p><strong>Почему так:</strong><br> сначала группируем <strong>все</strong> строки и считаем итог <code>SUM(amount)</code> по каждой категории; затем <code>HAVING total_qty &gt;= 25</code> отбрасывает категории с малой суммой.</p><p><strong>Интерпретация:</strong><br> категория пройдёт, даже если в ней <strong>нет ни одной</strong> отдельной строки <code>&gt;= 25</code>, но суммарно набирается <code>&gt;= 25</code> за счёт многих мелких заказов.</p><hr><h2 id="порядок-и-«скелет»-запроса-своднои-аналитики" tabindex="-1"><a class="header-anchor" href="#порядок-и-«скелет»-запроса-своднои-аналитики"><span>Порядок и «скелет» запроса сводной аналитики</span></a></h2><ol><li>Сформулировать вопрос на обычном языке.</li><li>Выбрать ключ группировки.</li><li>Выбрать агрегаты.</li><li>Доп-фильтры по строкам (<code>WHERE</code>).</li><li>Фильтр по итогам групп (<code>HAVING</code>).</li><li>Сортировка результатов (<code>ORDER BY</code>) и порог (<code>LIMIT</code>).</li></ol><p>Шаблон:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span> group_key<span class="token punctuation">,</span> AGG<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> metric<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line"><span class="token keyword">FROM</span> <span class="token keyword">table</span></span>
<span class="line"><span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> group_key</span>
<span class="line"><span class="token punctuation">[</span><span class="token keyword">HAVING</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> metric <span class="token keyword">DESC</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">[</span><span class="token keyword">LIMIT</span> N<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="типичные-ошибки-и-как-их-избежать" tabindex="-1"><a class="header-anchor" href="#типичные-ошибки-и-как-их-избежать"><span>Типичные ошибки и как их избежать</span></a></h2><ul><li><strong>Выбор неагрегированных полей вне <code>GROUP BY</code>.</strong> Работает не везде / даёт недетерминированные значения. Решение: добавьте поле в <code>GROUP BY</code> или заверните в агрегат/выражение.</li><li><strong>Использование <code>HAVING</code> вместо <code>WHERE</code> для построчных условий.</strong> Если критерий относится к строкам (напр. <code>amount &gt;= 10</code>) — это <code>WHERE</code>. Если к агрегатам группы (<code>SUM(amount) &gt;= 25</code>) — это <code>HAVING</code>.</li><li><strong>Неуправляемый порядок строк.</strong> Добавляйте явный <code>ORDER BY</code> по метрике/ключу.</li><li><strong>Смешение регистров/вариантов написания ключа группировки.</strong> Нормализуйте (<code>LOWER(...)</code>, <code>TRIM(...)</code>) в <code>GROUP BY</code>.</li></ul><hr><h2 id="практические-задания" tabindex="-1"><a class="header-anchor" href="#практические-задания"><span>Практические задания</span></a></h2><h3 id="задание-1" tabindex="-1"><a class="header-anchor" href="#задание-1"><span>Задание 1</span></a></h3>`,14)),p(i,{data:[{id:"Условие"},{id:"Решение"}]},{title0:t(({value:e,isActive:l})=>[...a[0]||(a[0]=[n("Условие",-1)])]),title1:t(({value:e,isActive:l})=>[...a[1]||(a[1]=[n("Решение",-1)])]),tab0:t(({value:e,isActive:l})=>[...a[2]||(a[2]=[s("p",null,[n("Выведите "),s("strong",null,"суммарное количество единиц"),n(" по всем заказам и "),s("strong",null,"общее количество заказов"),n(" в таблице одним запросом.")],-1),s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token comment"},"-- Ваш код можете писать тут")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)])]),tab1:t(({value:e,isActive:l})=>[...a[3]||(a[3]=[s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token keyword"},"SELECT")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token function"},"SUM"),s("span",{class:"token punctuation"},"("),n("amount"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token keyword"},"AS"),n(" total_qty"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token function"},"COUNT"),s("span",{class:"token punctuation"},"("),s("span",{class:"token operator"},"*"),s("span",{class:"token punctuation"},")"),n("    "),s("span",{class:"token keyword"},"AS"),n(" total_orders")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"FROM"),n(" orders"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),_:1}),a[64]||(a[64]=s("h3",{id:"задание-2",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#задание-2"},[s("span",null,"Задание 2")])],-1)),p(i,{data:[{id:"Условие"},{id:"Решение"}]},{title0:t(({value:e,isActive:l})=>[...a[4]||(a[4]=[n("Условие",-1)])]),title1:t(({value:e,isActive:l})=>[...a[5]||(a[5]=[n("Решение",-1)])]),tab0:t(({value:e,isActive:l})=>[...a[6]||(a[6]=[s("p",null,[n("В первом запросе выведите "),s("strong",null,"уникальных покупателей"),n(", а во втором запросе "),s("strong",null,"посчитайте их количество"),n(".")],-1),s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token comment"},"-- Ваш код можете писать тут")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)])]),tab1:t(({value:e,isActive:l})=>[...a[7]||(a[7]=[s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token keyword"},"SELECT")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token keyword"},"DISTINCT"),n(" customer "),s("span",{class:"token keyword"},"AS"),n(" unique_customers")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"FROM"),n(" orders"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"SELECT")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token function"},"COUNT"),s("span",{class:"token punctuation"},"("),s("span",{class:"token keyword"},"DISTINCT"),n(" customer"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token keyword"},"AS"),n(" unique_customers_count")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"FROM"),n(" orders"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),_:1}),a[65]||(a[65]=s("h3",{id:"задание-3",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#задание-3"},[s("span",null,"Задание 3")])],-1)),p(i,{data:[{id:"Условие"},{id:"Решение"}]},{title0:t(({value:e,isActive:l})=>[...a[8]||(a[8]=[n("Условие",-1)])]),title1:t(({value:e,isActive:l})=>[...a[9]||(a[9]=[n("Решение",-1)])]),tab0:t(({value:e,isActive:l})=>[...a[10]||(a[10]=[s("p",null,[n("Покажите "),s("strong",null,"топ-3 категории"),n(" с "),s("strong",null,"наибольшими суммарными продажами"),n(", отсортировав по количеству товаров "),s("strong",null,"по убыванию"),n(".")],-1),s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token comment"},"-- Ваш код можете писать тут")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)])]),tab1:t(({value:e,isActive:l})=>[...a[11]||(a[11]=[s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token keyword"},"SELECT")]),n(`
`),s("span",{class:"line"},[n("  category"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token function"},"SUM"),s("span",{class:"token punctuation"},"("),n("amount"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token keyword"},"AS"),n(" total_qty")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"FROM"),n(" orders")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"GROUP"),n(),s("span",{class:"token keyword"},"BY"),n(" category")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"ORDER"),n(),s("span",{class:"token keyword"},"BY"),n(" total_qty "),s("span",{class:"token keyword"},"DESC")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"LIMIT"),n(),s("span",{class:"token number"},"3"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),_:1}),a[66]||(a[66]=s("h3",{id:"задание-4",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#задание-4"},[s("span",null,"Задание 4")])],-1)),p(i,{data:[{id:"Условие"},{id:"Решение"}]},{title0:t(({value:e,isActive:l})=>[...a[12]||(a[12]=[n("Условие",-1)])]),title1:t(({value:e,isActive:l})=>[...a[13]||(a[13]=[n("Решение",-1)])]),tab0:t(({value:e,isActive:l})=>[...a[14]||(a[14]=[s("p",null,[n("Для каждого покупателя выведите "),s("strong",null,"среднее количество товаров в заказе"),n(" и "),s("strong",null,"число заказов"),n(", отсортируйте по "),s("strong",null,"среднему по убыванию"),n(".")],-1),s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token comment"},"-- Ваш код можете писать тут")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)])]),tab1:t(({value:e,isActive:l})=>[...a[15]||(a[15]=[s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token keyword"},"SELECT")]),n(`
`),s("span",{class:"line"},[n("  customer"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token function"},"AVG"),s("span",{class:"token punctuation"},"("),n("amount"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token keyword"},"AS"),n(" avg_per_order"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token function"},"COUNT"),s("span",{class:"token punctuation"},"("),n("id"),s("span",{class:"token punctuation"},")"),n("   "),s("span",{class:"token keyword"},"AS"),n(" orders_count")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"FROM"),n(" orders")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"GROUP"),n(),s("span",{class:"token keyword"},"BY"),n(" customer")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"ORDER"),n(),s("span",{class:"token keyword"},"BY"),n(" avg_per_order "),s("span",{class:"token keyword"},"DESC"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),_:1}),a[67]||(a[67]=s("h3",{id:"задание-5",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#задание-5"},[s("span",null,"Задание 5")])],-1)),p(i,{data:[{id:"Условие"},{id:"Решение"}]},{title0:t(({value:e,isActive:l})=>[...a[16]||(a[16]=[n("Условие",-1)])]),title1:t(({value:e,isActive:l})=>[...a[17]||(a[17]=[n("Решение",-1)])]),tab0:t(({value:e,isActive:l})=>[...a[18]||(a[18]=[s("p",null,[n("Оставьте только те "),s("strong",null,"категории"),n(", в которых суммарные продажи составили "),s("strong",null,"не менее 50-ти"),n(" единиц товара.")],-1),s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token comment"},"-- Ваш код можете писать тут")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)])]),tab1:t(({value:e,isActive:l})=>[...a[19]||(a[19]=[s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token keyword"},"SELECT")]),n(`
`),s("span",{class:"line"},[n("  category"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token function"},"SUM"),s("span",{class:"token punctuation"},"("),n("amount"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token keyword"},"AS"),n(" total_qty")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"FROM"),n(" orders")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"GROUP"),n(),s("span",{class:"token keyword"},"BY"),n(" category")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"HAVING"),n(" total_qty "),s("span",{class:"token operator"},">="),n(),s("span",{class:"token number"},"50")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"ORDER"),n(),s("span",{class:"token keyword"},"BY"),n(" total_qty "),s("span",{class:"token keyword"},"DESC"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),_:1}),a[68]||(a[68]=s("h3",{id:"задание-6",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#задание-6"},[s("span",null,"Задание 6")])],-1)),p(i,{data:[{id:"Условие"},{id:"Решение"}]},{title0:t(({value:e,isActive:l})=>[...a[20]||(a[20]=[n("Условие",-1)])]),title1:t(({value:e,isActive:l})=>[...a[21]||(a[21]=[n("Решение",-1)])]),tab0:t(({value:e,isActive:l})=>[...a[22]||(a[22]=[s("p",null,[n("Оставьте только тех "),s("strong",null,"покупателей"),n(", которые совершили "),s("strong",null,"не более 5 заказов"),n(", но при этом приобрели "),s("strong",null,"не менее 30 единиц"),n(" товаров суммарно. Результат отсортируйте сначала по количеству заказов по убыванию, а затем по покупателю в алфавитном порядке.")],-1),s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token comment"},"-- Ваш код можете писать тут")]),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"}),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),s("codapi-snippet",{sandbox:"sqlite",editor:"basic","depends-on":"orders_02_sqlite.sql"},null,-1)])]),tab1:t(({value:e,isActive:l})=>[...a[23]||(a[23]=[s("div",{class:"language-sql line-numbers-mode","data-highlighter":"prismjs","data-ext":"sql"},[s("pre",null,[s("code",{class:"language-sql"},[s("span",{class:"line"},[s("span",{class:"token keyword"},"SELECT")]),n(`
`),s("span",{class:"line"},[n("  customer"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token function"},"COUNT"),s("span",{class:"token punctuation"},"("),n("id"),s("span",{class:"token punctuation"},")"),n("   "),s("span",{class:"token keyword"},"AS"),n(" orders_count"),s("span",{class:"token punctuation"},",")]),n(`
`),s("span",{class:"line"},[n("  "),s("span",{class:"token function"},"SUM"),s("span",{class:"token punctuation"},"("),n("amount"),s("span",{class:"token punctuation"},")"),n(),s("span",{class:"token keyword"},"AS"),n(" total_qty")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"FROM"),n(" orders")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"GROUP"),n(),s("span",{class:"token keyword"},"BY"),n(" customer")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"HAVING"),n(" orders_count "),s("span",{class:"token operator"},"<="),n(),s("span",{class:"token number"},"5"),n(),s("span",{class:"token operator"},"AND"),n(" total_qty "),s("span",{class:"token operator"},">="),n(),s("span",{class:"token number"},"30")]),n(`
`),s("span",{class:"line"},[s("span",{class:"token keyword"},"ORDER"),n(),s("span",{class:"token keyword"},"BY"),n(" orders_count "),s("span",{class:"token keyword"},"DESC"),s("span",{class:"token punctuation"},","),n(" customer "),s("span",{class:"token keyword"},"ASC"),s("span",{class:"token punctuation"},";")]),n(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),_:1})])}const y=r(m,[["render",b]]),h=JSON.parse('{"path":"/disciplines/it03/lectures/07_lecture.html","title":"ИТ.03 - 07 - Агрегатные функции, операторы GROUP BY и HAVING","lang":"ru-RU","frontmatter":{"description":"ИТ.03 - 07 - Агрегатные функции, операторы GROUP BY и HAVING Введение На предыдущих занятиях вы освоили выборку и фильтрацию данных (SELECT, WHERE, LIKE, сортировку, ограничение...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"ИТ.03 - 07 - Агрегатные функции, операторы GROUP BY и HAVING\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-10-23T15:23:50.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://it.vshp.online/disciplines/it03/lectures/07_lecture.html"}],["meta",{"property":"og:site_name","content":"Кафедра ИТ"}],["meta",{"property":"og:title","content":"ИТ.03 - 07 - Агрегатные функции, операторы GROUP BY и HAVING"}],["meta",{"property":"og:description","content":"ИТ.03 - 07 - Агрегатные функции, операторы GROUP BY и HAVING Введение На предыдущих занятиях вы освоили выборку и фильтрацию данных (SELECT, WHERE, LIKE, сортировку, ограничение..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ru-RU"}],["meta",{"property":"og:updated_time","content":"2025-10-23T15:23:50.000Z"}],["meta",{"property":"article:modified_time","content":"2025-10-23T15:23:50.000Z"}]]},"git":{"updatedTime":1761233030000,"contributors":[{"name":"PAVEL TKACHEV","username":"","email":"phoenixweiss@ya.ru","commits":4}],"changelog":[{"hash":"0ce876945812065c588454b8937315869506e77b","time":1761233030000,"email":"phoenixweiss@ya.ru","author":"PAVEL TKACHEV","message":"Update 06_lecture.md and 07_lecture.md"},{"hash":"45206a2d17a353a305fde4e7c95b24c1383ed079","time":1761203077000,"email":"phoenixweiss@ya.ru","author":"PAVEL TKACHEV","message":"Update 07_lecture.md"},{"hash":"ee4177d3bc5f5dd8ff575610791788e2fe451011","time":1761200950000,"email":"phoenixweiss@ya.ru","author":"PAVEL TKACHEV","message":"Update 07_lecture.md, orders_02_sqlite.sql, and table_orders_02.md"},{"hash":"ab5fd36737a0ea60ccccb52a8f0146255c9a349b","time":1761149769000,"email":"phoenixweiss@ya.ru","author":"PAVEL TKACHEV","message":"Update settings.json, <a href=\\"http://index.md\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">index.md</a>, 06_lecture.md, and 4 more files"}]},"autoDesc":true,"filePathRelative":"disciplines/it03/lectures/07_lecture.md"}');export{y as comp,h as data};
