# Сайт кафедры Информационных Технологий (ЧУВО «ВШП») — VuePress

Официальный сайт кафедры информационных технологий ЧУВО «ВШП», построенный на **VuePress** и управляемый через **Yarn**. Сайт — открытый для широкой публики официальный ресурс кафедры. Права и ограничения использования материалов — в лицензии:

[![Лицензия](https://badgers.space/badge/Лицензия/VSHP-EMLicense/781F18)](https://github.com/vshp-online/VSHP-EMLicense/blob/main/LICENSE.md)

---

## Технологии

- VuePress — генератор статических сайтов на базе Vue.
- Yarn — менеджер пакетов.
- Node.js LTS — рекомендуемая среда выполнения.

---

## Предварительные требования

- **Node.js**: LTS (проверьте `node -v`)
- **Yarn**: `npm i -g yarn` (если не установлен)

---

## Быстрый старт (локально)

```bash
# Установка зависимостей
yarn

# Запуск локального дев-сервера на http://localhost:8080
yarn dev

# Обновить версию лицензии до config.vshpLicenseRef из package.json
yarn license:update

# Сборка статики
yarn build

# Запуск собранной статики на http://localhost:3000
yarn serve

# Развертывание текущей версии на GithubPages
yarn deploy

# Для интерактивного обновления зависимостей
yarn upgrade-interactive

# Запуск сквозных тестов (поднимает dev-сервер автоматически)
yarn test:e2e
```

---

## Тестирование

- **Headless прогон:** `yarn test:e2e` — команда поднимет `yarn dev`, дождётся `http://localhost:8080` и выполнит `cypress run`, после чего сервер будет остановлен.
- **Интерактивно:** `yarn cy:open`, выбрать режим E2E и сценарий `main.cy.js`, чтобы наблюдать шаги в UI.

Перед запуском Cypress убедитесь, что dev-сервер доступен (для `test:e2e` это делается автоматически, для `cy:open` — вручную через `yarn dev`).

---

## Добавление новостей в блог

1. Используйте скрипт: `yarn post:create "Заголовок новости" [featured=true|false] ["Выдержка новости"] ["Короткий заголовок для списка"]`.
   - Например, `yarn post:create "Запуск новой лаборатории" true` создаст файл сразу с `featured: true`.
   - Пример с выдержкой: `yarn post:create "Новый учебный год" false "В этом году мы запускаем несколько новых курсов"` создаст пост с указанной выдержкой.
   - Пример с коротким заголовком: `yarn post:create "Очень длинный заголовок новости, который неудобно отображать в списке" false "" "Краткий заголовок"` создаст пост с коротким заголовком для отображения в списке новостей.
   - Если выдержка не указана, система автоматически извлечет первые 150 символов содержимого новости для использования в качестве выдержки.
   - Если короткий заголовок не указан, в списке новостей будет отображаться основной заголовок (из H1 заголовка файла).
2. Будет создан файл `blog/YYYY-MM-DD-HH-MM.md` с московским временем в названии и базовым frontmatter `tags: []`, `featured: false`.
3. Откройте файл, дополните теги, содержимое и при необходимости поменяйте статус `featured`.
4. `featured` — отметка «избранной» записи:
   - `true` выводит пост в блок «Избранные записи блога» на главной и подсвечивает его бейджем «На главной» в карточке/странице;
   - используйте флаг для редких материалов — крупных запусков, кейсов и инициатив, которые нужно держать на виду.
5. После сохранения при следующем `yarn dev`/`yarn build` плагин блога обновит `public/data/blog-posts.json`, а страница блога подхватит новую запись.

Если пост должен остаться только в ленте, оставляйте `featured: false` (значение по умолчанию).

При необходимости можно создавать файлы вручную, но важно сохранять формат имени `YYYY-MM-DD-HH-MM.md`, чтобы плагин корректно определял дату.

### Поддержка полей во frontmatter

Новости могут содержать дополнительные поля во frontmatter, которые влияют на отображение в списке новостей и в метаданных страницы.

#### Выдержка (excerpt)

Новости могут содержать выдержку (аннотацию), которая отображается в списке новостей и в метаданных страницы.

1. **Явное указание выдержки**: можно указать выдержку явно во frontmatter с помощью поля `excerpt`:

   ```yaml
   ---
   title: Заголовок новости для списка
   date: 2025-11-12T10:00:00.000Z
   tags: [теги]
   featured: false
   excerpt: "Это явно указанная выдержка новости, которая будет отображаться в списке новостей и в метаданных страницы."
   ---
   ```

2. **Автоматическое извлечение**: если поле `excerpt` отсутствует во frontmatter, система автоматически извлекает первые 160 символов содержимого новости (без учета markdown разметки) для использования в качестве выдержки.

Рекомендуется явно указывать выдержку для лучшего контроля над отображением анонса новости.

#### Заголовок (title)

Для отображения в списке новостей можно указать короткий заголовок с помощью поля `title` во frontmatter:

```yaml
---
title: Короткий заголовок для списка
date: 2025-11-12T10:00:00.000Z
tags: [теги]
featured: false
excerpt: "Это выдержка новости"
---
```

Если поле `title` отсутствует во frontmatter, в списке новостей будет отображаться основной заголовок новости (из H1 заголовка файла).

---

## Экспорт таблиц SQLite для лекций

Чтобы быстро получить Markdown-представление таблиц из SQL-файла, используйте скрипт [`export_sqlite_table.sh`](./scripts/export_sqlite_table.sh).

### Требования

- установлен `sqlite3`;
- у скрипта есть права на запуск:

  ```bash
  chmod +x scripts/export_sqlite_table.sh
  ```

### Использование

```bash
# экспорт всех таблиц в папку <db>_db
scripts/export_sqlite_table.sh path/to/file.sql

# задать папку назначения
scripts/export_sqlite_table.sh path/to/file.sql ./custom_dir

# экспорт только указанных таблиц
scripts/export_sqlite_table.sh path/to/file.sql --tables=teachers,courses
```

По умолчанию рядом с файлом создаётся директория `<имя_дампа>_db`, в которой появляются файлы `<table>_table.md`. Например, `learning_portal_sqlite.sql` превратится в папку `learning_portal_db/` с `teachers_table.md`, `courses_table.md` и др.

### Что делает скрипт

- создаёт временную базу данных (`:memory:`) и выполняет SQL-код из файла;
- автоматически перечисляет пользовательские таблицы и выгружает все (или выбранные) в Markdown;
- явно отображает `NULL`, чтобы отличать его от пустых строк;
- принимает фильтр `--tables=tbl1,tbl2` для выборочного экспорта таблиц.

---

## Лицензия и уведомления

Все материалы публикуются в **образовательных целях** и распространяются по лицензии **VSHP-EMLicense**. Материалы доступны **исключительно для образовательных целей**. Коммерческое использование и распространение за пределами ЧУВО «ВШП» и партнёров — **только с письменного согласия** кафедры ИТ. По вопросам прав и разрешений обращаться по указанным ниже контактам.

[Полный текст лицензии](https://github.com/vshp-online/VSHP-EMLicense/blob/main/LICENSE.md).

---

## Контакты

Кафедра информационных технологий ЧУВО «ВШП»

- Сайт: [https://it.vshp.online/](https://it.vshp.online/)
- Email: [it@vshp.online](mailto:it@vshp.online)
