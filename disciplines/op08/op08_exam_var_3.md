# ОП.08 - Практический экзамен - Вариант №3

## База данных коллекции фильмов

Необходимо разработать БД, в которой должны быть отражены следующие сущности:

- Сущность «Фильм»
  - Атрибут «Название фильма»
  - Атрибут «Год выхода»
  - Атрибут «Бюджет»
- Сущность «Режиссер»
  - Атрибут «Полное имя режиссера»
- Сущность «Жанр»
  - Атрибут «Жанр фильма»
- Сущность «Кинокомпания»
  - Атрибут «Название кинокомпании»

При этом, учесть, что:

- У фильма может быть только один режиссер и только одна кинокомпания
- У фильма может быть только один жанр
- У режиссера может быть несколько фильмов
- Одна кинокомпания могла снять несколько фильмов с разными режиссерами
- У разных фильмов может быть одна кинокомпания и режиссер

Необходимо четко указывать названия таблиц и полей, в которые будет занесена информация.

Необходимо импортировать в созданную БД данные:

::: details exam_var_3_data.sql

@[code sql:collapsed-lines=5](./includes/exam_var_3_data.sql)

:::

## Задачи

Необходимо разнести данные из временной таблицы `tmp` в каждую из вновь созданных в соответствии со структурой таблиц БД, при этом сохранив все связи, после чего таблицу `tmp` необходимо удалить из БД.

Необходимо написать соответствующие SQL-запросы для выполнения следующих действий с базой данных:

1. Вывести сколько фильмов сняла одна любая кинокомпания с одним и тем же режиссером
2. Вывести сколько всего фильмов было снято одной любой кинокомпанией
3. Вывести количество снятых фильмов любой кинокомпанией за последние 10 лет
4. Вывести жанры фильмов в которых снимал один любой режиссер в течении всей своей карьеры
5. Вывести все фильмы, снятые самой большой кинокомпанией (по сумме бюджетов фильмов)
6. Вывести 5 самых дорогих фильмов
7. Вывести режиссера с самым большим количеством фильмов

::: tip

Рекомендуемый порядок разбора данных:

1. __Жанр__ (первичный ключ `id` генерируемый)
2. __Кинокомпания__ (первичный ключ `id` генерируемый)
3. __Режиссер__ (первичный ключ `id` генерируемый)
4. __Фильм__ (можно использовать `id` из `tmp` как первичный ключ)

:::

## Результат

Задание должно быть выполнено в локальной файловой системе компьютера. Папка со всеми файлами задания должна называться:

__`ОП.08 - Вариант 3 - Иванов И.И.`__

где вместо `Иванов И.И.` должны быть указаны фамилия и инициалы сдающего.

Результат выполнения задания должен быть оформлен в виде файлов:

1. Файл дампа итоговой БД в формате SQL, должен называться: `db_3.sql`
2. Файл последовательных SQL-запросов для каждого из пунктов задания, должен называться: `task_3.sql`, каждый запрос должен отделяться комментарием с номером соответствующего пункта задания
3. Файл, отражающий ERD-диаграмму созданной БД со всеми связями, должен называться `erd_3.png`
