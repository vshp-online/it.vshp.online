-- ===========================
-- 1. Тестирование хранимой процедуры book_room
-- ===========================

-- Пример успешного вызова: бронирование номера
CALL book_room(1, 1, 1, '2024-06-01', '2024-06-05');

-- Пример вызова с ошибкой: номер уже забронирован
CALL book_room(1, 1, 1, '2024-06-01', '2024-06-05');
-- Ожидаемый результат: ошибка "Номер уже забронирован"

-- Пример вызова с ошибкой: гость не найден
CALL book_room(999, 1, 1, '2024-06-01', '2024-06-05');
-- Ожидаемый результат: ошибка "Гость, номер или сотрудник не найдены"

-- Проверка результата
SELECT * FROM bookings;

-- ===========================
-- 2. Тестирование пользовательской функции calculate_stay_cost
-- ===========================

-- Пример вызова: расчёт стоимости проживания
SELECT calculate_stay_cost(1, 4) AS stay_cost;

-- Пример вызова: неверный номер
SELECT calculate_stay_cost(999, 4) AS stay_cost;
-- Ожидаемый результат: возвращается 0

-- ===========================
-- 3. Тестирование триггера log_room_status_update
-- ===========================

-- Пример вызова: изменение статуса номера
UPDATE rooms
SET status = 'booked'
WHERE id = 1;

-- Проверка результата: логи изменений
SELECT * FROM change_logs;

-- ===========================
-- 4. Тестирование представления employee_booking_summary
-- ===========================

-- Пример вызова: получение данных из представления
SELECT * FROM employee_booking_summary;
